<html lang="en" class="fontawesome-i2svg-active fontawesome-i2svg-complete"><head><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="google-site-verification" content="kxRO_dkLLlBil8CxoFb-GLMR7Y7koHcbPDddiaXKT-0">
<meta property="og:site_name" content="BFI site">

<meta http-equiv="Imagetoolbar" content="no">

    <style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.3333333333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor);opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}</style><link rel="shortcut icon" href="https://whatson.bfi.org.uk/content/Files/BFI-Branding/shortcut_icon.png?_7.85.1">

    <link rel="apple-touch-icon" href="https://whatson.bfi.org.uk/content/Files/BFI-Branding/apple-touch-icon.png?_7.85.1">


<!-- inclusion of bootstrap specific CSS -->
<!-- http://twitter.github.com for documentation on bootstrap -->
<link rel="Stylesheet" href="/lib/bootstrap/css/bootstrap.min.css?_7.85.1">
<!-- end of bootstrap specific CSS -->

<!-- include the font awesome css for font icons-->
<link rel="Stylesheet" href="/lib/fontawesome-free/css/all.min.css">

<!-- include material design icons-->
<link rel="Stylesheet" href="/lib/material-design-icons/material-icons.css">

<link rel="stylesheet" href="../../content/images/branding/global.css?_=7.85.1" type="text/css">

<!--[if lt IE 9]>
    <link rel="stylesheet" href="../../content/images/branding/global_IE.css?_7.85.1" type="text/css">
<![endif]-->

<script type="text/javascript" async="" src="https://analytics.tiktok.com/i18n/pixel/static/identify_31760074.js"></script><script type="text/javascript" async="" src="https://analytics.tiktok.com/i18n/pixel/static/main.MWFhZTllNTFjMQ.js" data-id="CJMT2H3C77UDFRIUMFEG"></script><script src="https://connect.facebook.net/signals/config/367783743713127?v=2.9.255&amp;r=stable&amp;domain=whatson.bfi.org.uk&amp;hme=18f1088ef3e8892a74f943ddaee05e3bbd28c980d3b65c4c57d9fe86969d4bce&amp;ex_m=95%2C158%2C135%2C20%2C67%2C68%2C128%2C63%2C42%2C129%2C72%2C62%2C10%2C142%2C81%2C15%2C94%2C123%2C116%2C70%2C73%2C122%2C139%2C103%2C144%2C7%2C3%2C4%2C6%2C5%2C2%2C82%2C92%2C145%2C226%2C170%2C56%2C228%2C229%2C49%2C185%2C27%2C69%2C234%2C233%2C173%2C29%2C55%2C9%2C58%2C88%2C89%2C90%2C96%2C119%2C28%2C26%2C121%2C118%2C117%2C136%2C71%2C138%2C137%2C44%2C54%2C112%2C14%2C141%2C39%2C215%2C217%2C180%2C23%2C24%2C25%2C17%2C18%2C38%2C34%2C36%2C35%2C77%2C83%2C87%2C101%2C127%2C130%2C40%2C102%2C21%2C19%2C108%2C64%2C32%2C132%2C131%2C133%2C124%2C22%2C31%2C53%2C100%2C140%2C65%2C16%2C134%2C105%2C76%2C61%2C30%2C195%2C165%2C285%2C213%2C156%2C198%2C191%2C166%2C98%2C120%2C75%2C110%2C48%2C41%2C43%2C104%2C109%2C115%2C52%2C59%2C114%2C47%2C50%2C46%2C91%2C143%2C0%2C113%2C13%2C111%2C11%2C1%2C51%2C84%2C57%2C60%2C107%2C80%2C79%2C146%2C147%2C85%2C86%2C8%2C93%2C45%2C125%2C78%2C74%2C66%2C106%2C97%2C37%2C126%2C33%2C99%2C12%2C148" async=""></script><script async="" src="https://connect.facebook.net/en_US/fbevents.js"></script><script type="text/javascript" async="" src="https://analytics.tiktok.com/i18n/pixel/events.js?sdkid=CJMT2H3C77UDFRIUMFEG&amp;lib=ttq"></script><script defer="" src="//loader.wisepops.com/get-loader.js?v=1&amp;site=NYtyE7fa8V"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-KDQM4GMD8B&amp;cx=c&amp;gtm=4e61r1"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-PY0EGJB317&amp;cx=c&amp;gtm=4e61r1"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=AW-10970986637&amp;cx=c&amp;gtm=4e61r1"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=AW-994456046&amp;cx=c&amp;gtm=4e61r1"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=AW-1060402284&amp;cx=c&amp;gtm=4e61r1"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=DC-15344947&amp;cx=c&amp;gtm=4e61r1"></script><script async="" src="//www.googletagmanager.com/gtm.js?id=GTM-KHDW8Q"></script><script src="/lib/jquery/jquery.min.js?_=7.85.1" type="text/javascript"></script>


<script language="Javascript">
	
</script>    



	<link rel="stylesheet" href="/content/Files/D20-Theme/dev/2025/av_stylesheet_18-11-2025.min.css?_=7.85.1" type="text/css">


<script type="text/javascript">

</script>
<script type="text/javascript">
  // Check whether cookies are enabled.
	document.cookie = "TestCookie=1";
	var testCookie = document.cookie;

	// Try to retrieve the value we just set.
	if (testCookie.indexOf("TestCookie=1") == -1)
	{
		
		    document.location = "error.asp?nocookie=";
		
    }
	else
		document.cookie = "TestCookie=;expires=Thu, 01-Jan-1970 00:00:00 GMT";
</script>

<script type="text/javascript">

function setRSVPButtons(response, eventCode)
{
                var url = '/' + eventCode + '/invited?user=' + response.authResponse.userID + '&access_token=' + response.authResponse.accessToken;
                 FB.api(url, 'get',
                 function (response) {
                    if (!response || response.error) {
                      new showAlertPopup("Error occurred:" + response.error.message, "", "", "", "", "");
                    }
                    else
                    {
                        if (response.data[0].rsvp_status == "attending")
                        {
                            var buttons = document.getElementsByName("attendingButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).disabled = true;
                                buttons.item(x).style.display = "inline";
                            }
                            buttons = document.getElementsByName("maybeButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).style.display = "inline";
                            }
                        }
                        else if (response.data[0].rsvp_status == "unsure")
                        {
                            var buttons = document.getElementsByName("attendingButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).style.display = "inline";
                            }
                            buttons = document.getElementsByName("maybeButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).disabled = true;
                                buttons.item(x).style.display = "inline";
                            }
                        }
                        else
                        {
                            var buttons = document.getElementsByName("attendingButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).style.display = "inline";
                            }
                            buttons = document.getElementsByName("maybeButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).style.display = "inline";
                            }
                        }
                    }
                });
}
function setRSVPButtonsLogin(eventCode)
{
        FB.getLoginStatus(function (response) {
            if (response.status == 'connected') {
                setRSVPButtons(response, eventCode);
            }
            else {
                FB.login(function (response) {
                    if (response.authResponse) {
                        setRSVPButtons(response, eventCode);
                    } else {
                    }
                }, { scope: 'rsvp_event,email,user_groups,publish_stream' });
            }
        });
        return true;
}

function rsvpToFBEvent(status, response, eventCode)
{

                var url = '/' + eventCode + '/' + status + '?access_token=' + response.authResponse.accessToken;

                 FB.api(url, 'post',
                 function (response) {
                    if (!response || response.error) {
                      new showAlertPopup("Error occurred:" + response.error.message, "", "", "", "", "");
                    }
                    else
                    {
                      gaTrackEvent('Facebook', 'RSVP to Event Success');

                        if (status == "attending")
                        {
                            var buttons = document.getElementsByName("attendingButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).disabled = true;
                            }
                            buttons = document.getElementsByName("maybeButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).disabled = false;
                            }
                        }
                        else if (status == "maybe")
                        {
                            var buttons = document.getElementsByName("maybeButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).disabled = true;
                            }
                            buttons = document.getElementsByName("attendingButton" + eventCode);
                            for (var x = 0; x < buttons.length; x++)
                            {
                                buttons.item(x).disabled = false;
                            }
                        }
                    }
                 });
}

function rsvpToFBEventLogin(status, eventCode) {

        FB.getLoginStatus(function (response) {
            if (response.status == 'connected') {
                rsvpToFBEvent(status, response, eventCode);
            }
            else {
                FB.login(function (response) {
                    if (response.authResponse) {
                        rsvpToFBEvent(status, response, eventCode);
                    } else {
                    }
                }, { scope: 'rsvp_event,email,user_groups,publish_stream' });
            }
        });
        return true;
}
</script>
<script type="text/javascript" src="../../Common/browser_detect.js?_=7.85.1"></script>
<script type="text/javascript">
  var genericConfirmationMessage = "Are you sure?";
  var offerExpired = "We\'re sorry, your order has expired.";
  var admissionsExpired = "An offer on one of your tickets has expired.";
  var alertHeaderText = "Attention";
  var termsHeaderText = "Terms and Conditions";
  var helpHeaderText = "Help";
  var sectionHeaderText = "More info";

  var okayButtonText = "OK";
  var cancelButtonText = "Cancel";
  var acceptButtonText = "Accept";
  var declineButtonText = "Decline";
  var closeButtonText = "Close";

  var sTokenName = 'sToken';
  var sToken = '1,763f9237,697cc74f,266534E1-B9FB-4FF2-8730-21345B4DF857,q7eCic6B7u9lW6yaG+iD1Yaf/5s=';
</script>
<script type="text/javascript" src="../../Common/online-jscript.js?_=7.85.1"></script>
<script type="text/javascript" src="../../Common/online-navigation-jscript.js?_=7.85.1"></script>
<script type="text/javascript" src="../../Common/Widgets/widgetParent.js?_=7.85.1"></script>
<script type="text/javascript">
/*

*/
function displayMessage(onClickEvent)
{

        new showAlertPopup("", "", "undefined", "", "", "", onClickEvent);
      
}

function tsOrderChanged( url )
{
  new showConfirmPopup( '', 'The current order has unsaved changes that may be lost. Continue anyway?', function () { document.location = url }, '' );
}

// Used for drop-down menu in IE 6
<!--//--><![CDATA[//><!--
function startList() {
	if (document.all&&document.getElementById) {
		navRoot = document.getElementById("menuTop");
		for (i=0; i<navRoot.childNodes.length; i++) {
			node = navRoot.childNodes[i];
			if (node.id=="menuTopItem") {
				node.onmouseover=function() {
					this.className+=" over";
				}

                node.onfocus=function(){
                    this.className+=" over";
                }

				node.onmouseout=function() {
					this.className=this.className.replace(" over", "");
				}

                node.onblur=function() {
					this.className=this.className.replace(" over", "");
				}
			}
		}
	}
}
//--><!]]>

var plusApi_loaded = false;
var twitterApi_loaded = false;
var fbApi_loaded = false;

    fbApi_loaded = true;

</script>
<noscript>
  <meta http-equiv="refresh" content="0; URL=error.asp">
</noscript>




<title>Welcome to BFI Southbank online</title>
<meta http-equiv="Imagetoolbar" content="no">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="google-site-verification" content="kxRO_dkLLlBil8CxoFb-GLMR7Y7koHcbPDddiaXKT-0">
<meta property="og:site_name" content="BFI site">


<!-- inclusion of bootstrap specific CSS -->
<!-- http://twitter.github.com for documentation on bootstrap -->
<link rel="Stylesheet" href="/lib/bootstrap/css/bootstrap.min.css?_7.85.1">
<!-- end of bootstrap specific CSS -->

<!-- include the font awesome css for font icons-->
<link rel="Stylesheet" href="/lib/fontawesome-free/css/all.min.css">

<!-- include material design icons-->
<link rel="Stylesheet" href="/lib/material-design-icons/material-icons.css">

<link rel="stylesheet" href="../../content/images/branding/global.css?_=7.85.1" type="text/css">

<!--[if lt IE 9]>
    <link rel="stylesheet" href="../../content/images/branding/global_IE.css?_7.85.1" type="text/css">
<![endif]-->

<script src="/lib/jquery/jquery.min.js?_=7.85.1" type="text/javascript"></script>

	<link rel="stylesheet" href="/content/Files/D20-Theme/dev/2025/av_stylesheet_18-11-2025.min.css?_7.85.1" type="text/css">


<script type="text/javascript" async="" src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/994456046/?random=1769785168075&amp;cv=11&amp;fst=1769785168075&amp;bg=ffffff&amp;guid=ON&amp;async=1&amp;en=gtag.config&amp;gtm=45be61r1v9118782764z871417101za20gzb71417101zd71417101xec&amp;gcd=13l3l3l3l1l1&amp;dma=0&amp;tag_exp=103116026~103200004~104527907~104528501~104684208~104684211~115938466~115938469~116185181~116185182~116988315~117041587&amp;u_w=1920&amp;u_h=1080&amp;url=https%3A%2F%2Fwhatson.bfi.org.uk%2FOnline%2Ferror.asp&amp;frm=0&amp;tiba=Welcome%20to%20BFI%20Southbank%20online&amp;hn=www.googleadservices.com&amp;npa=0&amp;pscdl=noapi&amp;auid=1775119982.1769785168&amp;uaa=x86&amp;uab=64&amp;uafvl=Chromium%3B143.0.7499.4%7CNot%2520A(Brand%3B24.0.0.0&amp;uamb=0&amp;uam=&amp;uap=macOS&amp;uapv=10_15_7&amp;uaw=0&amp;data=event%3Dgtag.config&amp;rfmt=3&amp;fmt=4"></script><script type="text/javascript" async="" src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/10970986637/?random=1769785168136&amp;cv=11&amp;fst=1769785168136&amp;bg=ffffff&amp;guid=ON&amp;async=1&amp;en=gtag.config&amp;gtm=45be61r1v893484208z871417101za20gzb71417101zd71417101xec&amp;gcd=13l3l3l3l1l1&amp;dma=0&amp;tag_exp=103116026~103200004~104527907~104528500~104573694~104684208~104684211~115938466~115938469~116185181~116185182~116988315~117041588&amp;u_w=1920&amp;u_h=1080&amp;url=https%3A%2F%2Fwhatson.bfi.org.uk%2FOnline%2Ferror.asp&amp;frm=0&amp;tiba=Welcome%20to%20BFI%20Southbank%20online&amp;hn=www.googleadservices.com&amp;npa=0&amp;pscdl=noapi&amp;auid=1775119982.1769785168&amp;uaa=x86&amp;uab=64&amp;uafvl=Chromium%3B143.0.7499.4%7CNot%2520A(Brand%3B24.0.0.0&amp;uamb=0&amp;uam=&amp;uap=macOS&amp;uapv=10_15_7&amp;uaw=0&amp;data=event%3Dgtag.config&amp;rfmt=3&amp;fmt=4"></script><script type="text/javascript" async="" src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/1060402284/?random=1769785168171&amp;cv=11&amp;fst=1769785168171&amp;bg=ffffff&amp;guid=ON&amp;async=1&amp;en=gtag.config&amp;gtm=45be61r1v877331210z871417101za20gzb71417101zd71417101xec&amp;gcd=13l3l3l3l1l1&amp;dma=0&amp;tag_exp=103116026~103200004~104527907~104528501~104573694~104684208~104684211~115938466~115938468~116185181~116185182~116988316~117041588&amp;u_w=1920&amp;u_h=1080&amp;url=https%3A%2F%2Fwhatson.bfi.org.uk%2FOnline%2Ferror.asp&amp;frm=0&amp;tiba=Welcome%20to%20BFI%20Southbank%20online&amp;hn=www.googleadservices.com&amp;npa=0&amp;pscdl=noapi&amp;auid=1775119982.1769785168&amp;uaa=x86&amp;uab=64&amp;uafvl=Chromium%3B143.0.7499.4%7CNot%2520A(Brand%3B24.0.0.0&amp;uamb=0&amp;uam=&amp;uap=macOS&amp;uapv=10_15_7&amp;uaw=0&amp;data=event%3Dgtag.config&amp;rfmt=3&amp;fmt=4"></script></head>
<body>


<script type="text/javascript">

/**
 * Returns the unique values for a given property from an array of items.
 * If there is only one unique value, returns that value directly.
 * If there are multiple unique values, returns an array of those values.
 *
 * @param {Array} items - The array of objects to extract unique values from.
 * @param {string} propertyToGet - The property name to extract unique values for.
 * @returns {Array|any} An array of unique values if more than one exists, otherwise the single unique value.
 */
const getUniqueValues = (items, propertyToGet) => {
    if (!items || !Array.isArray(items) || items.length === 0) {
        return [];
    }
    const uniquesList = [...new Set(items.map(item => item[propertyToGet]))]
    return uniquesList.length > 1 ? uniquesList : uniquesList[0];
};

/**
* Decodes a string containing numeric HTML entities (e.g., &#243; -> รณ).
* @param {string} encodedText - The string to decode.
* @returns {string} The decoded (clean) string.
*/
function decodeHtmlEntities(encodedText) {
	if (typeof encodedText !== 'string' || !encodedText) return "";
	var textarea = document.createElement('textarea');
	textarea.innerHTML = encodedText;
	return textarea.value;
}

/**
* Normalizes a string for GTM: converts it to lowercase and replaces spaces with underscores.
* Example: "Palco/Platea VR" -> "palco/platea_vr"
* @param {string} str - The string to normalize.
* @returns {string} The normalized string.
*/
function tsNormalizeGtmString(value) {
	if (value == null || typeof value === 'undefined' || value === "")
	{
		return "";
	}
	const str = value.toString();
	const decodedStr = decodeHtmlEntities(str);
	return decodedStr.toLowerCase().replace(/\s+/g, '_');
}

/**
* Normalizes a string/Array for GTM: converts it to lowercase and replaces spaces with underscores.
* Example: "Palco/Platea VR" -> "palco/platea_vr"
* Example: ["Palco","Platea VR"] -> ["palco","platea_vr"]
* @param {string|string[]}str - The string/array to normalize.
* @returns {string|string[]} The normalized data.
*/
function tsNormalizeGtmData(data) {
	if (Array.isArray(data)) {
		return data.map(item => tsNormalizeGtmString(item));
	}

	return tsNormalizeGtmString(data);
}

/**
 * Takes an array of admission objects and performs the following steps:
 * 1. Normalizes the string fields (price_type, section, promotion, price_zone) to lowercase and replaces spaces with underscores.
 * 2. Groups admissions that share the same item_id, price, price_type, price_zone, promotion, and section.
 * 3. Increments the quantity for grouped items.
 * 4. Returns an array of unique admissions, each with a quantity and value (quantity * price).
 *
 * @param {Array<Object>} admissions - The array of admission objects to normalize and group.
 * @returns {Array<Object>} An array of grouped and normalized admission objects, each with quantity and value.
 */
const normalizeAndGroupAdmissions = (admissions) => {
    if (!admissions || !Array.isArray(admissions)) {
        return [];
    }
	return admissions
		.map(item => ({
			...item,
			item_name: tsNormalizeGtmData(item.item_name),
			price_type: tsNormalizeGtmData(item.price_type),
			section: tsNormalizeGtmData(item.section),
			promotion: tsNormalizeGtmData(item.promotion),
			price_zone: tsNormalizeGtmData(item.price_zone),
		}))
		.reduce((acc, item) => {
			// Group items that have the same performance id, price, price_type, price_zone, promotion and section
			const key = [item.item_id, item.price, item.price_type, item.price_zone, item.promotion, item.section].join('|');

			const found = acc.find(i => i._groupKey === key);

			if (found) found.quantity += 1
			else acc.push({ ...item, quantity: item.quantity ?? 1, _groupKey: key });

			return acc;
		}, [])
        .map(({ _groupKey, quantity, price, ...rest }) => ({
            ...rest,
            quantity,
            price,
			value: quantity * parseFloat(price.includes(",") ? price.replace(",", ".") : price)
        })); // Remove the internal _groupKey property
}

/**
 * Generates an object for the data layer representing a single performance for ecommerce tracking.
 *
 * @param {Object} performanceData - The performance data object. Should contain:
 *   - item_id: {string} Unique identifier for the performance.
 *   - show: {string} Name of the show.
 *   - performance_date: {string} Date of the performance.
 *   - availability: {string|number} Number of available seats.
 *   - availability_default: {string|number} Total number of seats.
 *   - booking_type_default: {string} Default booking type ("seatmap" or "bestseat").
 * @param {string} booking_type - The booking type for the performance.
 * @returns {Object} An object formatted for the data layer, including:
 *   - items: {Array<Object>} Array with a single item containing performance details.
 *   - show: {string} Name of the show.
 *   - performance_date: {string} Date of the performance.
 *   - availability: {string|number} Number of available seats.
 *   - availability_default: {string|number} Total number of seats.
 *   - booking_type: {string} Booking type.
 *   - booking_type_default: {string} Default booking type.
 *   - referrer_code: {string} Referrer code from the session.
 * Returns an empty object if performanceData is invalid or an error occurs.
 */
function getPerformanceEcommerceObject(performanceData, booking_type) {
    try {
		let dataLayerObject = {};

        if (performanceData && performanceData.item_id) {
            const { item_id, show, performance_date, availability, availability_default, booking_type_default } = performanceData;
            const session = getSessionObject()
            dataLayerObject = {
                items: [
                    {
                        item_id,
                        item_name: tsNormalizeGtmData(show),
                        performance_date,
                        availability,
                        availability_default,
                        booking_type,
                        booking_type_default
                    }
                ],
                show: tsNormalizeGtmData(show),
                performance_date,
                availability,
                availability_default,
                booking_type,
                booking_type_default,
                referrer_code: session.av.session.referrer
            }
		}
		return dataLayerObject;
    } catch (error) {
        console.error("There was an issue getting the view item object", error);
        return {};
    }
}

/**
 * Returns a formatted and grouped list of admissions currently in the cart.
 *
 * @returns {Array<Object>} Array of grouped and formatted admission objects, each with a quantity.
 */
function getAdmissionsInCartList() {
	const admissions = [];
    return normalizeAndGroupAdmissions(admissions)
}

/**
 * Returns a formatted and grouped list of admissions currently in the created order.
 *
 * @returns {Array<Object>} Array of grouped and formatted admission objects, each with a quantity.
 */
function getAdmissionsInOrderList() { 
    const admissions = [];
    return normalizeAndGroupAdmissions(admissions)
}

/**
 * Collects and formats information about the current session and the admissions (cart items)
 * in the user's cart. It aggregates unique values for key properties (such as show, performance date, price zone, etc.)
 * and includes session-specific data like timeout and referrer code.
 *
 * @returns {Object} An object with the following properties:
 *   - items: {Array<Object>} The list of admissions currently in the cart, grouped and formatted.
 *   - show: {string|Array<string>} Unique show names in the cart.
 *   - performance_date: {string|Array<string>} Unique performance dates in the cart.
 *   - price_zone: {string|Array<string>} Unique price zones in the cart.
 *   - promotion: {string|Array<string>} Unique promotions in the cart.
 *   - availability: {string|Array<string>} Unique availability statuses in the cart.
 *   - availability_default: {string|Array<string>} Unique default availability values.
 *   - booking_type_default: {string} The default booking type for the cart items.
 *   - price_type: {string|Array<string>} Unique price types in the cart.
 *   - section: {string|Array<string>} Unique sections in the cart.
 *   - timeout: {string} The offer timeout value from the session.
 *   - referrer_code: {string} The referrer code from the session.
 */
function getEcommerceObject(type = "cart") {
	try {
        // type can only be "cart" or "order"
        if (!["cart", "order"].includes(type)) {
            throw new Error("Invalid type provided. Expected 'cart' or 'order'.");
		}	

		

		const typeMap = {
			cart: getAdmissionsInCartList(),
			order: getAdmissionsInOrderList()
		}

		const session = getSessionObject()
		const admissions = typeMap[type]

		let dataLayerObj = {
			items: admissions,
			show: getUniqueValues(admissions, "item_name"),
			performance_date: getUniqueValues(admissions, "performance_date"),
			price_zone: getUniqueValues(admissions, "price_zone"),
			promotion: getUniqueValues(admissions, "promotion"),
			availability: getUniqueValues(admissions, "availability"),
			availability_default: getUniqueValues(admissions, "availability_default"),
			price_type: getUniqueValues(admissions, "price_type"),
			section: getUniqueValues(admissions, "section"),
			timeout: "+20m",
			referrer_code: session.av.session.referrer,
			currency: admissions.length > 0 ? admissions[0].currency : "",
			quantity: admissions.reduce((total, item) => total + item.quantity, 0),
            value: "0",
		}

        // If the order has been placed, add additional order-related properties
	    

		return dataLayerObj
    } catch (error) {
        console.error("There was an issue getting the ecommerce object", error);
    }
}

function testValue(value, pattern)
{
  if(!value || !pattern)
    return false;

  if(pattern.constructor === RegExp)
    return pattern.test(value.toString());

  return value.toString() == pattern.toString();
}

function isGTM()
{
	return true;
}

function getSessionObject()
{
	return {av: {session: {language: "EN", 
role: "Internet", 
referrer: null, 
user_id: undefined, 
promo_codes: []}}};
}

function getErrorObject()
{
	
	return null;
	
}

function getPageObject()
{
	return {av: {page: { page_script: "/Online/error.asp", 
 search: { total_records: null, 
 total_pages: null, 
 page_size: null, 
 current_page: null, 
 criteria: { search_from :null, 
 search_to :null, 
 search_criteria :null, 
 category_filter :null, 
 city_filter :null, 
 venue_filter :null, 
 month_filter :null, 
 object_type_filter :null}}, 
 articles: [{article_name: "", article_title: "BFI Southbank header", article_type: "1", article_id: "BF81AEE7-7DBC-485B-A0CB-36D296291A93"},
{article_name: "", article_title: "2023 SB footer", article_type: "1", article_id: "92BC9D73-B5C6-4496-B749-C05C17427E3A"}],

          articleExists: function (article_type, article_title)    
          {
            if (article_type == null && article_title == null)
            {
              if(this.articles.length)
                return true;
            }
            else if (article_type == null)
            {
              for(var i = 0; i < this.articles.length; i++) {
                  if(testValue(this.articles[i].article_title, article_title))
                    return true;
              }
            }
            else if (article_title == null)
            {
              for(var i = 0; i < this.articles.length; i++) {
                if (testValue(this.articles[i].article_type, article_type))
                  return true;
              }
            }
            else
            {
              for(var i = 0; i < this.articles.length; i++) {
                if (testValue(this.articles[i].article_title, article_title) && testValue(this.articles[i].article_type, article_type))
                  return true;
              }
            }
    
            return false;
          }
	}}};
}


function getOrderEventObject()
{
	return {event: {av: {event: {order: {action: "" }}}, toString: function () { return "av.event.order-" + this.av.event.order.action;}}};
}

function getCartEventObject()
{
	return {event: {av: {event: {cart: {action: "" }}}, toString: function () { return "av.event.cart-" + this.av.event.cart.action;}}};
}

function admissionExists(object, product_name)
{
	var ids = new Array();
	for (var i = 0; i < object.performances.length; i++)
	{
		if (testValue(object.performances[i].name, product_name) ||    
			testValue(object.performances[i].description, product_name) ||
			testValue(object.performances[i].short_description, product_name))
		{
			ids.push(object.performances[i].performance_id);
		}
	}
	if (ids.length > 0)
	{
		for (var i = 0; i < object.order_admissions.length; i++)
		{
			if (ids.indexOf(object.order_admissions[i].performance_id) != -1)
			{
				return true;
			}
		}
	}
	return false;
}

function bundleExists(object, product_name)
{
	var ids = new Array();
	for (var i = 0; i < object.bundles.length; i++)
	{
		if (testValue(object.bundles[i].name, product_name) ||    
			testValue(object.bundles[i].description, product_name) ||
			testValue(object.bundles[i].short_description, product_name))
		{
			ids.push(object.bundles[i].bundle_id);
		}
	}
	if (ids.length > 0)
	{
		for (var i = 0; i < object.order_bundle.length; i++)
		{
			if (ids.indexOf(object.order_bundle[i].bundle_id) != -1)
			{
				return true;
			}
		}
	}
	return false;
}

function miscItemExists(object, product_name)
{
	var ids = new Array();
	for (var i = 0; i < object.misc_items.length; i++)
	{
		if (testValue(object.misc_items[i].name, product_name) ||    
			testValue(object.misc_items[i].description, product_name) ||
			testValue(object.misc_items[i].short_description, product_name))
		{
			ids.push(object.misc_items[i].miscellaneous_item_id);
		}
	}
	if (ids.length > 0)
	{
		for (var i = 0; i < object.order_misc_items.length; i++)
		{
			if (ids.indexOf(object.order_misc_items[i].item_id) != -1)
			{
				return true;
			}
		}
	}
	return false;
}

function giftExists(object, product_name)
{
	var ids = new Array();
	for (var i = 0; i < object.gifts.length; i++)
	{
		if (testValue(object.gifts[i].name, product_name) ||    
			testValue(object.gifts[i].description, product_name) ||
			testValue(object.gifts[i].short_description, product_name))
		{
			ids.push(object.gifts[i].gift_id);
		}
	}
	if (ids.length > 0)
	{
		for (var i = 0; i < object.order_gifts.length; i++)
		{
			if (ids.indexOf(object.order_gifts[i].gift_id) != -1)
			{
				return true;
			}
		}
	}
	return false;
}

function storeValueExists(object, product_name)
{
	var ids = new Array();
	for (var i = 0; i < object.stored_values.length; i++)
	{
		if (testValue(object.stored_values[i].name, product_name) ||    
			testValue(object.stored_values[i].description, product_name) ||
			testValue(object.stored_values[i].short_description, product_name))
		{
			ids.push(object.stored_values[i].stored_value_id);
		}
	}
	if (ids.length > 0)
	{
		for (var i = 0; i < object.order_stored_values.length; i++)
		{
			if (ids.indexOf(object.order_stored_values[i].stored_value_id) != -1)
			{
				return true;
			}
		}
	}
	return false;
}

function productExists(object, product_type, product_name)
{
	var result = false;
	if (product_name == null && product_type == null)
	{
		if (object.order_admissions.length || object.order_bundle.length || object.order_misc_items.length ||
		object.order_gifts.length || object.order_stored_values.length)
			result = true;
	}
	else if (product_name == null)
	{
		if (testValue(product_type, "admission") && object.order_admissions.length)
			result = true;
		if (testValue(product_type, "bundle") && object.order_bundle.length)
			result = true;
		if (testValue(product_type, "miscellaneous_item") && object.order_misc_items.length)
			result = true;
		if (testValue(product_type, "gift") && object.order_gifts.length)
			result = true;
		if (testValue(product_type, "stored_value") && object.order_stored_values.length)
			result = true;
	}
	else if (product_type == null)
	{
		if (object.order_admissions.length)
		{
			result = admissionExists(object, product_name);
		}
		if (object.order_bundle.length)
		{
			result = bundleExists(object, product_name);
		}
		if (object.order_misc_items.length)
		{
			result = miscItemExists(object, product_name);
		}
		if (object.order_gifts.length)
		{
			result = giftExists(object, product_name);
		}
		if (object.order_stored_values.length)
		{
			result = storeValueExists(object, product_name);
		}
	}
	else
	{
		if (testValue(product_type, "admission") && object.order_admissions.length)
		{
			result = admissionExists(object, product_name);
		}
		if (testValue(product_type, "bundle") && object.bundles.length)
		{
			result = bundleExists(object, product_name);
		}
		if (testValue(product_type, "miscellaneous_item") && object.misc_items.length)
		{
			result = miscItemExists(object, product_name);
		}
		if (testValue(product_type, "gift") && object.gifts.length)
		{
			result = giftExists(object, product_name);
		}
		if (testValue(product_type, "stored_value") && object.stored_values.length)
		{
			result = storeValueExists(object, product_name);
		}
	}
	return result;
}

function admissionValue(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.performances.length; i++)
	{
		if (testValue(object.performances[i].name, product_name) ||    
			testValue(object.performances[i].description, product_name) ||
			testValue(object.performances[i].short_description, product_name))
		{
			id.push(object.performances[i].performance_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_admissions.length; i++)
		{
			if (id.indexOf(object.order_admissions[i].performance_id) != -1)
			{
				result += object.order_admissions[i].amount.amount;
			}
		}
	}
	return result;
}

function bundleValue(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.bundles.length; i++)
	{
		if (testValue(object.bundles[i].name, product_name) ||    
			testValue(object.bundles[i].description, product_name) ||
			testValue(object.bundles[i].short_description, product_name))
		{
			id.push(object.bundles[i].bundle_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_bundle_admissions.length; i++)
		{
			if (id.indexOf(object.order_bundle_admissions[i].bundle_id) != -1)
			{
				result += object.order_bundle_admissions[i].amount.amount;
			}
		}
	}
	return result;
}

function miscItemValue(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.misc_items.length; i++)
	{
		if (testValue(object.misc_items[i].name, product_name) ||    
			testValue(object.misc_items[i].description, product_name) ||
			testValue(object.misc_items[i].short_description, product_name))
		{
			id.push(object.misc_items[i].miscellaneous_item_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_misc_items.length; i++)
		{
			if (id.indexOf(object.order_misc_items[i].item_id) != -1)
			{
				result += object.order_misc_items[i].amount.amount;
			}
		}
	}
	return result;
}

function giftValue(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.gifts.length; i++)
	{
		if (testValue(object.gifts[i].name, product_name) ||    
			testValue(object.gifts[i].description, product_name) ||
			testValue(object.gifts[i].short_description, product_name))
		{
			id.push(object.gifts[i].gift_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_gifts.length; i++)
		{
			if (id.indexOf(object.order_gifts[i].gift_id) != -1)
			{
				result += object.order_gifts[i].pledge_amount.amount;
			}
		}
	}
	return result;
}

function storedValueValue(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.stored_values.length; i++)
	{
		if (testValue(object.stored_values[i].name, product_name) ||    
			testValue(object.stored_values[i].description, product_name) ||
			testValue(object.stored_values[i].short_description, product_name))
		{
			id.push(object.stored_values[i].stored_value_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_stored_values.length; i++)
		{
			if (id.indexOf(object.order_stored_values[i].stored_value_id) != -1)
			{
				result += object.order_stored_values[i].amount.amount;
			}
		}
	}
	return result;
}

function productValue(object, product_type, product_name)
{
	var result = 0;
	if (product_name == null && product_type == null)
	{
		if (object.order_admissions.length)
		{
			for (var i = 0; i < object.order_admissions.length; i++)
			{
				result += object.order_admissions[i].amount.amount;
			}
		}
		if (object.order_bundle_admissions.length)
		{
			for (var i = 0; i < object.order_bundle_admissions.length; i++)
			{
				result += object.order_bundle_admissions[i].amount.amount;
			}
		}
		if (object.order_misc_items.length)
		{
			for (var i = 0; i < object.order_misc_items.length; i++)
			{
				result += object.order_misc_items[i].amount.amount;
			}
		}
		if (object.order_gifts.length)
		{
			for (var i = 0; i < object.order_gifts.length; i++)
			{
				result += object.order_gifts[i].pledge_amount.amount;
			}
		}
		if (object.order_stored_values.length)
		{
			for (var i = 0; i < object.order_stored_values.length; i++)
			{
				result += object.order_stored_values[i].amount.amount;
			}
		}
	}
	else if (product_name == null)
	{
		if (testValue(product_type, "admission") && object.order_admissions.length)
		{
			for (var i = 0; i < object.order_admissions.length; i++)
			{
				result += object.order_admissions[i].amount.amount;
			}
		}
		if (testValue(product_type, "bundle") && object.order_bundle_admissions.length)
		{
			for (var i = 0; i < object.order_bundle_admissions.length; i++)
			{
				result += object.order_bundle_admissions[i].amount.amount;
			}
		}
		if (testValue(product_type, "miscellaneous_item") && object.order_misc_items.length)
		{
			for (var i = 0; i < object.order_misc_items.length; i++)
			{
				result += object.order_misc_items[i].amount.amount;
			}
		}
		if (testValue(product_type, "gift") && object.order_gifts.length)
		{
			for (var i = 0; i < object.order_gifts.length; i++)
			{
				result += object.order_gifts[i].pledge_amount.amount;
			}
		}
		if (testValue(product_type, "stored_value") && object.order_stored_values.length)
		{
			for (var i = 0; i < object.order_stored_values.length; i++)
			{
				result += object.order_stored_values[i].amount.amount;
			}
		}
	}
	else if (product_type == null)
	{
		if (object.order_admissions.length)
		{
			result += admissionValue(object, product_name);
		}
		if (object.order_bundle_admissions.length)
		{
			result += bundleValue(object, product_name);
		}
		if (object.order_misc_items.length)
		{
			result += miscItemValue(object, product_name);
		}
		if (object.order_gifts.length)
		{
			result += giftValue(object, product_name);
		}
		if (object.order_stored_values.length)
		{
			result += storedValueValue(object, product_name);
		}
	}
	else
	{
		if (testValue(product_type, "admission") && object.order_admissions.length)
		{
			result += admissionValue(object, product_name);
		}
		else if (testValue(product_type, "bundle") && object.bundles.length)
		{
			result += bundleValue(object, product_name);
		}
		else if (testValue(product_type, "miscellaneous_item") && object.misc_items.length)
		{
			result += miscItemValue(object, product_name);
		}
		else if (testValue(product_type, "gift") && object.gifts.length)
		{
			result += giftValue(object, product_name);
		}
		else if (testValue(product_type, "stored_value") && object.stored_values.length)
		{
			result += storedValueValue(object, product_name);
		}
	}
	return result;
}

function admissionCount(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.performances.length; i++)
	{
		if (testValue(object.performances[i].name, product_name) ||    
			testValue(object.performances[i].description, product_name) ||
			testValue(object.performances[i].short_description, product_name))
		{
			id.push(object.performances[i].performance_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_admissions.length; i++)
		{
			if (id.indexOf(object.order_admissions[i].performance_id) != -1)
			{
				result ++;
			}
		}
	}
	return result;
}

function bundleCount(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.bundles.length; i++)
	{
		if (testValue(object.bundles[i].name, product_name) ||    
			testValue(object.bundles[i].description, product_name) ||
			testValue(object.bundles[i].short_description, product_name))
		{
			id.push(object.bundles[i].bundle_id);
		}
	}
	if (id.length > 0 && object.order_bundle_admissions.length)
	{
		for (var i = 0; i < object.order_bundle_admissions.length; i++)
		{
			if (id.indexOf(object.order_bundle_admissions[i].bundle_id) != -1)
			{
				result ++;
			}
		}
	}
	return result;
}

function miscItemCount(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.misc_items.length; i++)
	{
		if (testValue(object.misc_items[i].name, product_name) ||    
			testValue(object.misc_items[i].description, product_name) ||
			testValue(object.misc_items[i].short_description, product_name))
		{
			id.push(object.misc_items[i].miscellaneous_item_id);
		}
	}
	if (id.length > 0 && object.order_misc_items.length)
	{
		for (var i = 0; i < object.order_misc_items.length; i++)
		{
			if (id.indexOf(object.order_misc_items[i].item_id) != -1)
			{
				result += parseFloat(object.order_misc_items[i].quantity);
			}
		}
	}
	return result;
}

function giftCount(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.gifts.length; i++)
	{
		if (testValue(object.gifts[i].name, product_name) ||    
			testValue(object.gifts[i].description, product_name) ||
			testValue(object.gifts[i].short_description, product_name))
		{
			id.push(object.gifts[i].gift_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_gifts.length; i++)
		{
			if (id.indexOf(object.order_gifts[i].gift_id) != -1)
			{
				result ++;
			}
		}
	}
	return result;
}

function storedValueCount(object, product_name)
{
	var id = new Array();
	var result = 0;
	for (var i = 0; i < object.stored_values.length; i++)
	{
		if (testValue(object.stored_values[i].name, product_name) ||    
			testValue(object.stored_values[i].description, product_name) ||
			testValue(object.stored_values[i].short_description, product_name))
		{
			id.push(object.stored_values[i].stored_value_id);
		}
	}
	if (id.length > 0)
	{
		for (var i = 0; i < object.order_stored_values.length; i++)
		{
			if (id.indexOf(object.order_stored_values[i].stored_value_id) != -1)
			{
				result ++;
			}
		}
	}
	return result;
}

function productCount(object, product_type, product_name)
{
	var result = 0;
	if (product_name == null && product_type == null)
	{
		if (object.order_admissions.length)
		{
			result += object.order_admissions.length;
		}
		if (object.order_bundle_admissions.length)
		{
			result += object.order_bundle_admissions.length;
		}
		if (object.order_misc_items.length)
		{
			for (var i = 0; i < object.order_misc_items.length; i++)
				result += parseFloat(object.order_misc_items[i].quantity);
		}
		if (object.order_gifts.length)
		{
			result += object.order_gifts.length;
		}
		if (object.order_stored_values.length)
		{
			result += object.order_stored_values.length;
		}
	}
	else if (product_name == null)
	{
		if (testValue(product_type, "admission") && object.order_admissions.length)
		{
			result += object.order_admissions.length;
		}
		if (testValue(product_type, "bundle") && object.order_bundle_admissions.length)
		{
			result += object.order_bundle_admissions.length;
		}
		if (testValue(product_type, "miscellaneous_item") && object.order_misc_items.length)
		{
			for (var i = 0; i < object.order_misc_items.length; i++)
				result += parseFloat(object.order_misc_items[i].quantity);
		}
		if (testValue(product_type, "gift") && object.order_gifts.length)
		{
			result += object.order_gifts.length;
		}
		if (testValue(product_type, "stored_value") && object.order_stored_values.length)
		{
			result += object.order_stored_values.length;
		}
	}
	else if (product_type == null)
	{
		if (object.order_admissions.length)
		{
			result += admissionCount(object, product_name);
		}
		if (object.order_bundle_admissions.length)
		{
			result += bundleCount(object, product_name);
		}
		if (object.order_misc_items.length)
		{
			result += miscItemCount(object, product_name);
		}
		if (object.order_gifts.length)
		{
			result += giftCount(object, product_name);
		}
		if (object.stored_values.length)
		{
			result += storedValueCount(object, product_name);
		}
	}
	else
	{
		if (testValue(product_type, "admission") && object.order_admissions.length)
		{
			result += admissionCount(object, product_name);
		}
		if (testValue(product_type, "bundle") && object.order_bundle_admissions.length)
		{
			result += bundleCount(object, product_name);
		}
		if (testValue(product_type, "miscellaneous_item") && object.order_misc_items.length)
		{
			result += miscItemCount(object, product_name);
		}
		if (testValue(product_type, "gift") && object.order_gifts.length)
		{
			result += giftCount(object, product_name);
		}
		if (testValue(product_type, "stored_value") && object.order_stored_values.length)
		{
			result += storedValueCount(object, product_name);
		}
	}
	return result;
}

function getPerformance(object, performance_id)
{
	var result = null;
    
	if (performance_id != null && object.performances.length)
	{
		for (var i = 0; i < object.performances.length; i++)
		{
			if (testValue(object.performances[i].performance_id, performance_id))
			{
				result = object.performances[i];
				break;
			}
		}    
	}
    
	return result;
}

function getBundle(object, bundle_id)
{
	var result = null;
    
	if (bundle_id != null && object.bundles.length)
	{
		for (var i = 0; i < object.bundles.length; i++)
		{
			if (testValue(object.bundles[i].bundle_id, bundle_id))
			{
				result = object.bundles[i];
				break;
			}
		}    
	}
    
	return result;
}

function getMiscItem(object, miscitem_id)
{
	var result = null;
    
	if (miscitem_id != null && object.misc_items.length)
	{
		for (var i = 0; i < object.misc_items.length; i++)
		{
			if (testValue(object.misc_items[i].miscellaneous_item_id, miscitem_id))
			{
				result = object.misc_items[i];
				break;
			}
		}    
	}
    
	return result;
}

function getGift(object, gift_id)
{
	var result = null;
    
	if (gift_id != null && object.gifts.length)
	{
		for (var i = 0; i < object.gifts.length; i++)
		{
			if (testValue(object.gifts[i].gift_id, gift_id))
			{
				result = object.gifts[i];
				break;
			}
		}    
	}
    
	return result;
}

function getStoredValue(object, storedvalue_id)
{
	var result = null;
    
	if (storedvalue_id != null && object.stored_values.length)
	{
		for (var i = 0; i < object.stored_values.length; i++)
		{
			if (testValue(object.stored_values[i].stored_value_id, storedvalue_id))
			{
				result = object.stored_values[i];
				break;
			}
		}    
	}
    
	return result;
}

function createGAAdmissions(object, transactionProducts, GA4ecommerceItems)
{
	if( object.order_admissions.length > 0 )
	{
		var admissionList = new Array();
		var admissionPTList = new Array();
		for (var i = 0; i < object.order_admissions.length; i++)
		{
			var perfID = object.order_admissions[i].performance_id;
			if( admissionList[ perfID ] == undefined )
			{
				admissionList[ perfID ] = new Array();
			}
			admissionList[ perfID ].push( object.order_admissions[i] );

			if( admissionPTList[ perfID ] == undefined )
			{
				admissionPTList[ perfID ] = new Array();
			}
			var curPTList = admissionPTList[ perfID ];
			var admPTID = object.order_admissions[i].price_type;
			if (curPTList[ admPTID ] == undefined )
			{
				curPTList[ admPTID ] = new Array();
			}
			curPTList[ admPTID ].push( object.order_admissions[i] );
		}
		for( var guid in admissionList )
		{
			var admNode = admissionList[ guid ][ 0 ];
			var perfID = admNode.performance_id;
			var perfNode;
			for (var i = 0; i < object.performances.length; i++)
			{
				if (perfID == object.performances[i].performance_id)
				{
					perfNode = object.performances[i];
					break;
				}
			}    
			var perfName = perfNode.name;
			var perfDesc = perfNode.short_description;
			if (perfDesc == "" || perfDesc == null) {
				perfDesc = perfName;
			}
			var seriesName = perfNode.series_name;

			var curPTList = admissionPTList[ perfID ];
			for ( var guid in curPTList )
			{
				seatNode = curPTList[ guid ][ 0 ];
				var admAmount = seatNode.amount.amount;
				var priceTypeLabel = seatNode.price_type;
				var priceZoneLabel = seatNode.price_zone;

				var admissions = { "sku": perfName + " Admission " + priceTypeLabel + "-" + priceZoneLabel,
				"name": perfDesc + " Admission",    
				"category": seriesName + " Admission",
				"price": admAmount,
				"quantity": curPTList[ guid ].length
				};

				var GA4admissions = {
					"item_id": perfName,
					"item_name": perfDesc,
					"item_category": "Admission",
					"item_category2": seriesName,
					"item_category3": priceTypeLabel,
					"item_category4": priceZoneLabel,
					"price": admAmount,
					"quantity": curPTList[ guid ].length
				};

				transactionProducts.push(admissions);
				GA4ecommerceItems.push(GA4admissions);
			}
		}
	}
}

function createGABundles(object, transactionProducts, GA4ecommerceItems)
{
	// roll up bundles by id and price
	// object.order_bundle - data about the bundle on the order: amount, total
	// object.bundles - data about the bundle item: name & description

	if( object.bundles.length > 0 )
	{
		var bundleList = {};
		for (var i = 0; i < object.order_bundle.length; i++)
		{
			var bundleID = object.order_bundle[i].bundle_id;
			var bundleAmount = object.order_bundle[i].amount.amount;

			if( bundleList[ bundleID ] == undefined )
			{
				bundleList[ bundleID ] = {};
			}
			if( bundleList[ bundleID ][ bundleAmount ] == undefined )
			{
				bundleList[ bundleID ][ bundleAmount ] = 0;
			}
			bundleList[ bundleID ][ bundleAmount ]++;
		}

		for (var i = 0; i < object.bundles.length; i++)
		{
			var bundleID = object.bundles[i].bundle_id;
			var sku = object.bundles[i].name;
			var name = object.bundles[i].description;
			var shortDesc = object.bundles[i].short_description;
			if (shortDesc == null) {
				shortDesc = sku;
			}

			for(var amount in bundleList[bundleID])
			{
				transactionProducts.push(
				{
					"sku": sku,
					"name": name,    
					"price": amount,
					"quantity": bundleList[bundleID][amount]
				});

				GA4ecommerceItems.push(
				{
					"item_id": sku,
					"name": shortDesc,
					"item_category": "Bundle",
					"price": amount,
					"quantity": bundleList[bundleID][amount]
				});
			}
		}
	}
}

function createGAMiscItems(object, transactionProducts, GA4ecommerceItems)
{
	if( object.misc_items.length > 0 && object.order_misc_items.length > 0)
	{
		var itemList = new Array();
		var itemAmountList = new Array();
		for (var i = 0; i < object.order_misc_items.length; i++)
		{
			var itemID = object.order_misc_items[i].item_id;
			if( itemList[ itemID ] == undefined )
            {
              itemList[ itemID ] = new Array();
            }
            itemList[ itemID ].push( object.order_misc_items[i] );
			if( itemAmountList[ itemID ] == undefined )
              itemAmountList[ itemID ] = parseFloat(object.order_misc_items[i].amount.amount);
		}
		for (var i = 0; i < object.misc_items.length; i++)
		{
			var miscItems = { "sku": object.misc_items[i].name,
			"name": object.misc_items[i].description,    
			"category": object.misc_items[i].category,    
			"price": itemAmountList[object.misc_items[i].miscellaneous_item_id],
			"quantity": itemList[object.misc_items[i].miscellaneous_item_id].length
			};

			var shortDesc = object.misc_items[i].short_description;
            if (shortDesc == null) {
                shortDesc = object.misc_items[i].name;
            }

			var GA4miscItems = {
					"item_id": object.misc_items[i].name,
					"item_name": shortDesc,
					"item_category": "Miscellaneous Item",
					"item_category2": object.misc_items[i].category,
					"price": itemAmountList[object.misc_items[i].miscellaneous_item_id],
					"quantity": itemList[object.misc_items[i].miscellaneous_item_id].length
				};
    
			transactionProducts.push(miscItems);
			GA4ecommerceItems.push(GA4miscItems);
		}
	}
}

function createGAGifts(object, transactionProducts, GA4ecommerceItems)
{
	if( object.gifts.length > 0 && object.order_gifts.length > 0)
	{
		var giftList = new Array();
		for (var i = 0; i < object.gifts.length; i++)
		{
			var giftID = object.gifts[i].gift_id;
			if( giftList[ giftID ] == undefined )
			{
				giftList[ giftID ] = new Array();
			}
			giftList[ giftID ] = object.gifts[i].name;
		}
		for (var i = 0; i < object.order_gifts.length; i++)
		{
			var gifts = { "sku": giftList[object.order_gifts[i].gift_id],
			"name": object.order_gifts[i].appeal_id,    
			"category": object.order_gifts[i].fund,    
			"price": object.order_gifts[i].pledge_paid_amount.amount,
			"quantity": 1
			};

			var GA4gifts = {
					"item_id": giftList[object.order_gifts[i].gift_id],
					"item_name": object.order_gifts[i].appeal_id,
					"item_category": "Gift",
					"item_category2": object.order_gifts[i].fund,
					"price": object.order_gifts[i].pledge_paid_amount.amount,
					"quantity": 1
				};

			transactionProducts.push(gifts);
			GA4ecommerceItems.push(GA4gifts);
		}
	}
}

function createGAStoredValueItems(object, transactionProducts, GA4ecommerceItems)
{
	if( object.stored_values.length > 0 )
	{
		var storedValueNameList = new Array();
		var storedValueTypeList = new Array();
		var storedValueDescList = new Array();
		var storedValueShortDescList = new Array();
		for (var i = 0; i < object.stored_values.length; i++)
		{
			var certID = object.stored_values[i].stored_value_id;
			if( storedValueNameList[ certID ] == undefined )
			{
				storedValueNameList[ certID ] = new Array();
				storedValueTypeList[ certID ] = new Array();
				storedValueDescList[ certID ] = new Array();
				storedValueShortDescList[ certID ] = new Array();
			}
			storedValueNameList[ certID ] = object.stored_values[i].name;
			storedValueDescList[ certID ] = object.stored_values[i].description;
			storedValueShortDescList[ certID ] = object.stored_values[i].short_description;
			storedValueTypeList[ certID ] = object.stored_values[i].type;
		}
		for (var i = 0; i < object.order_stored_values.length; i++)
		{
			var storedValueItems = { "sku": storedValueNameList[object.order_stored_values[i].stored_value_id],
			"name": storedValueDescList[object.order_stored_values[i].stored_value_id],    
			"category": storedValueTypeList[object.order_stored_values[i].stored_value_id],    
			"price": parseFloat(object.order_stored_values[i].amount.amount),
			"quantity": 1
			};

			var shortDesc = storedValueShortDescList[object.order_stored_values[i].stored_value_id];
			if (shortDesc == null) {
				shortDesc = storedValueNameList[object.order_stored_values[i].stored_value_id];
			}

			var GA4storedValueItems = {
					"item_id": storedValueNameList[object.order_stored_values[i].stored_value_id],
					"item_name": shortDesc,
					"item_category": "Stored Value Item",
					"item_category2": storedValueTypeList[object.order_stored_values[i].stored_value_id],
					"price": parseFloat(object.order_stored_values[i].amount.amount),
					"quantity": 1
				};

			transactionProducts.push(storedValueItems);
			GA4ecommerceItems.push(GA4storedValueItems);
		}
	}
}

function createGATransaction(object)
{
	var output;
	var transactionProducts = new Array;
	var GA4ecommerceItems = new Array;

	createGAAdmissions(object, transactionProducts, GA4ecommerceItems);
	createGABundles(object, transactionProducts, GA4ecommerceItems);
	createGAMiscItems(object, transactionProducts, GA4ecommerceItems);
	createGAGifts(object, transactionProducts, GA4ecommerceItems);
	createGAStoredValueItems(object, transactionProducts, GA4ecommerceItems);

	output = { "transactionId": object.order_number.toString(),
				"transactionAffiliation": object.affiliation == null ? "" : object.affiliation.toString(),    
				"transactionTotal": object.grand_total.amount,
				"transactionTax": object.total_tax.amount,
				"transactionShipping": object.delivery_charges.amount,
				"transactionCity": object.customer_city == null ? "" : object.customer_city.toString(),
				"transactionState": object.customer_state == null ? "" : object.customer_state.toString(),
				"transactionCountry": object.customer_country == null ? "" : object.customer_country.toString(),
				"transactionProducts": transactionProducts,
				"ecommerce": {
					"transaction_id": object.order_number.toString(),
					"value": object.grand_total.amount,
					"tax": object.total_tax.amount,
					"shipping": object.delivery_charges.amount,
					"currency": object.grand_total.currency,
					"items": GA4ecommerceItems
				}
			};

	return output;
}



</script>

	<script type="text/javascript">
		var dataLayer = new Array();
		dataLayer.push(getSessionObject());
		dataLayer.push(getPageObject());
		var av_error = getErrorObject();
		if (av_error != null)
			dataLayer.push(av_error);        
		
    </script>
	<!-- Google Tag Manager -->
	<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-KHDW8Q"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-KHDW8Q');</script>
	<!-- End Google Tag Manager -->
	
    <div id="header">

            <div class="header-content container">
<div class="Brand" xmlns="http://www.w3.org/1999/xhtml" xmlns:av="http://www.audienceview.com/xml/email/"><a class="no-class" href="default.asp" shape="rect"><img alt="BFI Southbank home" class="Brand__img" src="data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2298px%22%20height%3D%22100px%22%20viewBox%3D%220%200%2098%20100%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%20%20%20%20%20%20%20%20%3Ctitle%3EBranding%20%2F%20BFI%20Logo%20%2F%20Black%3C%2Ftitle%3E%20%20%20%20%3Cdesc%3ECreated%20with%20Sketch.%3C%2Fdesc%3E%20%20%20%20%3Cg%20id%3D%22Branding-%2F-BFI-Logo-%2F-Black%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%20%20%20%20%20%20%20%20%3Cg%20id%3D%22BFI-Logo-Copy%22%20fill%3D%22%23FFFFFF%22%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M28.0268%2C15.3963%20C28.0268%2C13.4183%2027.2448%2C12.3063%2026.0908%2C11.6473%20C25.2678%2C11.1943%2024.4018%2C11.1103%2022.8368%2C11.1103%20L19.8298%2C11.1103%20L19.7468%2C20.0093%20L22.8778%2C20.0093%20C26.0078%2C20.0093%2028.0268%2C18.3613%2028.0268%2C15.3963%22%20id%3D%22Fill-15%22%3E%3C%2Fpath%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M23.7001%2C23.6355%20L19.7461%2C23.6355%20L19.6641%2C33.1925%20L23.4561%2C33.1925%20C26.7901%2C33.1925%2029.5111%2C31.7905%2029.5111%2C28.3305%20C29.5111%2C25.1185%2026.7081%2C23.6355%2023.7001%2C23.6355%22%20id%3D%22Fill-16%22%3E%3C%2Fpath%3E%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M80.422%2C66.402%20C80.315%2C66.402%2080.211%2C66.416%2080.104%2C66.418%20C81.703%2C62.801%2082.607%2C58.808%2082.607%2C54.599%20C82.607%2C38.419%2069.493%2C25.303%2053.313%2C25.303%20C50.451%2C25.303%2047.692%2C25.733%2045.077%2C26.498%20C45.285%2C25.263%2045.418%2C24.002%2045.418%2C22.708%20C45.418%2C10.166%2035.25%2C0%2022.71%2C0%20C10.166%2C0%200%2C10.166%200%2C22.708%20C0%2C35.248%2010.166%2C45.416%2022.71%2C45.416%20C23.686%2C45.416%2024.641%2C45.334%2025.584%2C45.215%20C24.586%2C48.164%2024.021%2C51.312%2024.021%2C54.599%20C24.021%2C70.775%2037.136%2C83.89%2053.313%2C83.89%20C56.984%2C83.89%2060.481%2C83.185%2063.719%2C81.953%20C63.69%2C82.356%2063.658%2C82.758%2063.658%2C83.168%20C63.658%2C92.427%2071.163%2C99.933%2080.422%2C99.933%20C89.682%2C99.933%2097.187%2C92.427%2097.187%2C83.168%20C97.187%2C73.908%2089.682%2C66.402%2080.422%2C66.402%20L80.422%2C66.402%20Z%20M24.194%2C36.57%20L12.124%2C36.57%20L12.124%2C33.192%20L15.01%2C33.192%20L15.174%2C11.111%20L12.124%2C11.111%20L12.124%2C7.731%20L23.618%2C7.731%20C26.627%2C7.731%2028.522%2C8.063%2030.294%2C9.379%20C31.652%2C10.37%2032.889%2C12.388%2032.889%2C14.817%20C32.889%2C18.157%2030.827%2C21.122%2027.163%2C21.41%20L27.163%2C21.491%20C31.035%2C21.45%2034.617%2C24.088%2034.617%2C28.496%20C34.617%2C33.397%2031.157%2C36.57%2024.194%2C36.57%20L24.194%2C36.57%20Z%20M63.673%2C52.535%20L63.673%2C57.423%20L51.562%2C57.423%20L51.452%2C70.31%20L56.227%2C70.31%20L56.227%2C74.865%20L41.287%2C74.865%20L41.287%2C70.31%20L45.175%2C70.31%20L45.397%2C40.536%20L40.897%2C40.536%20L40.897%2C36.263%20L40.897%2C35.98%20L41.108%2C35.98%20L68.227%2C35.98%20L68.45%2C46.2%20L63.283%2C46.2%20L62.95%2C40.536%20L51.674%2C40.536%20L51.562%2C52.535%20L63.673%2C52.535%20Z%20M84.526%2C75.592%20L82.606%2C75.592%20L82.606%2C90.709%20L84.526%2C90.709%20L84.526%2C93.818%20L76.236%2C93.818%20L76.236%2C90.709%20L78.157%2C90.709%20L78.157%2C75.592%20L76.236%2C75.592%20L76.236%2C72.805%20L76.236%2C72.485%20L76.476%2C72.485%20L84.526%2C72.485%20L84.526%2C75.592%20Z%22%20id%3D%22Fill-17%22%3E%3C%2Fpath%3E%20%20%20%20%20%20%20%20%3C%2Fg%3E%20%20%20%20%3C%2Fg%3E%3C%2Fsvg%3E"> </a>
</div>

    </div>


        <a class="menu-toggle menu-button btn btn-secondary">
            <svg class="svg-inline--fa fa-align-justify fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="align-justify" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M432 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-128H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"></path></svg><!-- <span class="fas fa-align-justify"></span> -->
        </a>
    </div>

    <div class="content-wrapper">
    <div id="menu">
        <div class="menuContainer main-nav">

            <ul id="menuTop" class="nav">
       <li class="menuTopItem" id="menuTopItem-start-over">
                    <a name="error-StartOver" href="default.asp" class="menu_item" title="Start over">
                    Start over
                    </a>
        </li>
      </ul>

      </div>
    </div>


  <div id="content">
        <div class="container">
    <div role="main" class="bodyDetails" id="error">

                <div class="account-box error-box">




                    <div class="attention alert alert-warning">
                        We are currently experiencing technical difficulties at this time. We apologise for the inconvenience caused
                    </div>

                    <div class="navigation-box">
                        <input type="button" class="btn btn-secondary" name="error-StartOver" onclick="window.location='default.asp'" value="Back">
                    </div>



      <noscript>
                    <div class="attention alert">
                        <p>To proceed with this transaction you must enable JavaScript in your browser.</p>
                    </div>
      </noscript>

                <div class="fine-print">Need help? - please contact box.office@bfi.org.uk  and we will reply as soon as we're able.</div>
            </div>
    </div>

        </div><!--\\ .bodyDetails -->
    </div><!--\\ .container -->
</div><!--\\ #content -->
  <div role="contentinfo" id="footer">
    <div class="footer-content container">
<div class="footer__row footer__row--first" xmlns="http://www.w3.org/1999/xhtml" xmlns:av="http://www.audienceview.com/xml/email/">
<div class="row footer__inner">
<div class="col col-12 col-md-4">
<div class="footer__menu">
<ul>
	<li class="footer__link-container"><span class="footer__menu-item title_link footer__heading">BFI Southbank</span>
</li>
	<li class="footer__link-container">
	<div>London SE1 8XT</div>
	</li>
	<li class="footer__link-container menu-divider"><a class="footer__menu-item" href="article/plan-your-visit" shape="rect">Plan your visit</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="article/customer-charter" shape="rect">Our venue rules and customer charter</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/venue-hire" shape="rect">Venue hire</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/join-support" shape="rect">Join and support</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="article/data-protection" shape="rect">Data protection</a>
</li>
</ul>
</div>
</div>

<div class="col col-12 col-md-4">
<div class="footer__menu">
<ul>
	<li class="footer__link-container"><span class="footer__menu-item title_link footer__heading">Programme</span>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="article/tickets-booking" shape="rect">Tickets and booking</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="article/filmsindex" shape="rect">All films A-Z</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="article/programme-changes" shape="rect">Programme changes</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="article/bfisouthbankguide" shape="rect">BFI Southbank Guide</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/resources-events-teachers/education-events" shape="rect">Education events</a>
</li>
</ul>
</div>
</div>

<div class="col col-12 col-md-4">
<div class="footer__menu">
<ul>
	<li class="footer__link-container"><span class="footer__menu-item title_link footer__heading">Watch film with the BFI</span>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://whatson.bfi.org.uk/imax/Online/default.asp" shape="rect">BFI IMAX</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://player.bfi.org.uk/" shape="rect">BFI Player</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/bfi-festivals" shape="rect">Festivals</a>
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="footer__row footer__row--second" xmlns="http://www.w3.org/1999/xhtml" xmlns:av="http://www.audienceview.com/xml/email/">
<div class="row footer__inner">
<div class="footer__about-us col-12 col-md-6">
<h2 class="footer__heading">British Film Institute</h2>

<p class="footer__desc">We are a cultural charity, a National Lottery funding distributor, and the UKโs lead organisation for film and the moving image.</p>

<div class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/contact-us" shape="rect">Contact us</a>
</div>

<div class="footer__about-us-icon"><a class="footer__icon twitter" href="https://twitter.com/BFI" shape="rect" title="View our Twitter">&nbsp;</a> <a class="footer__icon facebook" href="https://www.facebook.com/BritishFilmInstitute/" shape="rect" title="View our Facebook">&nbsp;</a> <a class="footer__icon instagram" href="https://www.instagram.com/britishfilminstitute/" shape="rect" title="View our Instagram">&nbsp;</a> <a class="footer__icon linkedin" href="https://www.linkedin.com/company/british-film-institute" shape="rect" title="View our LinkedIn">&nbsp;</a> <a class="footer__icon youtube" href="https://www.youtube.com/user/BFIfilms" shape="rect" title="View our YouTube">&nbsp;</a>
</div>
</div>

<div class="footer__support-logos col-12 col-md-6">
<h2 class="footer__heading">Supported by</h2>

<div class="footer__sponsor-outer">
<div class="footer__images-holder">
<div class="footer__images"><img alt="Funded by UK Government" src="https://core-cms.bfi.org.uk/sites/default/files/core/funded-by-uk-government.svg">
</div>

<div class="footer__images"><img alt="Culture Recovery Fund" src="https://core-cms.bfi.org.uk/sites/default/files/core/here-for-culture.svg">
</div>

<div class="footer__images"><img alt="BFI receives National Lottery funding" src="https://core-cms.bfi.org.uk/sites/default/files/core/national-lottery.svg">
</div>
</div>
</div>
</div>
</div>
</div>

<div class="footer__row footer__row--last" xmlns="http://www.w3.org/1999/xhtml" xmlns:av="http://www.audienceview.com/xml/email/">
<div class="row footer__inner">
<div class="col col-12 col-md-6">
<ul class="footer__bottom-links">
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/terms-use" shape="rect">Terms of use</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/tickets-other-purchases-bfi-southbank" shape="rect">BFI ticket purchases</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/bfi-online-community-guidelines" shape="rect">Online community guidelines</a>
</li>
	<li class="footer__link-container"><a class="footer__menu-item" href="https://www.bfi.org.uk/privacy-policy" shape="rect">Privacy policy</a>
</li>
</ul>
</div>

<div class="col col-12 col-md-6">
<div class="footer__copyright">
<div>ยฉ2025&nbsp;British Film Institute. All rights reserved.</div>

<div>Registered charity 287780</div>

<div>Registered office 21 Stephen St, London W1T 1LN</div>
</div>
</div>
</div>
</div>

  </div>
</div><!--\\ .content-wrapper -->
<div id="fade" class="black_overlay"></div>



<!-- inclusion of bootstrap.js -->
<!-- http://twitter.github.com for documentation on bootstrap -->
<script src="/lib/bootstrap/js/bootstrap.bundle.min.js?_=7.85.1" type="text/javascript"></script>
<!-- end of bootstrap.js -->

<!-- Font Awesome for icons -->
<script src="/lib/fontawesome-free/js/all.min.js"></script><script type="text/javascript" id="" charset="">(function(x,q,P){function Gb(a){return a&&"object"==typeof a?!0===a.mode?a.test_title&&a.test_session_name&&a.environment?a:null:null:null}function mc(a){try{a=new URL(a);var b=new URLSearchParams(a.search),d=b.get("trackingplan_regression_mode");if("true"===d){var c={mode:!0,test_title:b.get("trackingplan_regression_test_title"),test_session_name:b.get("trackingplan_regression_test_session_name"),environment:b.get("trackingplan_regression_environment")};if(c=Gb(c),!c)return void ja({m:"TP Regression mode init failed - missing required parameters"});
q.setItem("_trackingplan_regression",JSON.stringify(c));P.log("TP Regression mode enabled",c)}else"false"===d&&(P.log("TP Regression mode disabled"),q.removeItem("_trackingplan_regression"))}catch(e){ja({m:"TP Regression mode init failed - catch"})}}function nc(){try{var a=q.getItem("_trackingplan_regression");return a?Gb(JSON.parse(a)):null}catch(b){return null}}function oc(a){try{a=new URL(a);var b=new URLSearchParams(a.search),d=b.get("trackingplan_live_debug");d&&(q.setItem("_trackingplan_session_id",
d),q.setItem("_trackingplan_session_ts",Date.now().toString()),q.setItem("_trackingplan_live_debug_mode","true"))}catch(c){}}function pc(a){var b="https://panel.trackingplan.com/plans/"+ba+"/?open_tracks_explorer\x3dtrue\x26te_session_id\x3d"+a;P.log("%cTrackingplan Live Debug mode is Enabled.%c\nThe session id is %c"+a+"%c.\nSee the live session at "+b+"\nDisable Live Debug Mode by executing %cTrackingplan.disableLiveDebugMode()","font-weight: bold;","","font-weight: bold;","","font-style: italic")}
function Hb(a){if(!Ib){Ib=!0;u({m:"unload event",e:a.type});S="beacon";var b={web_vitals:Jb,js_error_count:Kb,js_warning_count:Lb};ka({event_name:"page_unload",properties:b},!0);Ha||(ka({event_name:"pixels",properties:{pixels:Mb(),sent_at:a.type}},!0),Ha=!0);la("beacon")}}function ka(a,b){a={method:"POST",endpoint:"TRACKINGPLAN",payload:JSON.stringify(a)};M(a,b)}function qc(a){if(T.includes("img"))try{rc(a)}catch(b){u(b)}if(T.includes("xhr"))try{sc(a)}catch(b){u(b)}if(T.includes("beacon"))try{tc(a)}catch(b){u(b)}if(T.includes("form"))try{uc(a)}catch(b){u(b)}if(T.includes("ws"))try{vc(a)}catch(b){u(b)}if(T.includes("fetch"))try{wc(a)}catch(b){u(b)}if(T.includes("performance"))try{xc(a)}catch(b){u(b)}if(T.includes("message"))try{yc()}catch(b){u(b)}}
function ab(a){var b=Nb();q.setItem("_trackingplan_initial",JSON.stringify(X(b,a)))}function Nb(){try{return null===q.getItem("_trackingplan_initial")?{}:JSON.parse(q.getItem("_trackingplan_initial"))}catch(a){return{}}}function zc(){try{if((q.setItem("_tp_t","a"),"a"!==q.getItem("_tp_t"))||(q.removeItem("_tp_t"),"function"!=typeof navigator.sendBeacon))return!1}catch(a){return!1}return!0}function wa(a){return"string"==typeof a||a instanceof String}function ca(a){return JSON.stringify(a,function(b,
d){return d instanceof Element?d.nodeType:d})}function rc(a){var b=a.Object.getOwnPropertyDescriptor(a.HTMLImageElement.prototype,"src").set;a.Object.defineProperty(a.HTMLImageElement.prototype,"src",{set:function(c){return!wa(c)||16384<c.length?b.apply(this,arguments):(M({method:"GET",endpoint:c,protocol:"img"}),b.apply(this,arguments))}});var d=a.HTMLImageElement.prototype.setAttribute;a.HTMLImageElement.prototype.setAttribute=function(c,e){if("src"==c.toLowerCase()){if(!wa(e)||e.length>16384)return d.apply(this,
arguments);M({method:"GET",endpoint:e,protocol:"img"})}return d.apply(this,arguments)}}function Ob(a){try{a instanceof FormData&&(a=JSON.stringify(Object.fromEntries(a)))}catch(b){}return a}function sc(a){var b=a.XMLHttpRequest.prototype.open,d=a.XMLHttpRequest.prototype.send;a.XMLHttpRequest.prototype.open=function(c,e){return this._tpUrl=e,this._tpMethod=c,b.apply(this,arguments)};a.XMLHttpRequest.prototype.send=function(c){var e=Ob(c);return bb(e,function(f){M({method:this._tpMethod,endpoint:this._tpUrl,
payload:f,protocol:"xhr"})}.bind(this)),d.apply(this,arguments)}}function bb(a,b){var d=String.fromCharCode;try{if(a instanceof Blob){var c=new FileReader;c.onload=function(){var g=c.result.split(",")[1];b(g)};c.readAsDataURL(a)}else{if(a instanceof ArrayBuffer){a="";for(var e=new Uint8Array(buffer),f=e.byteLength,h=0;h<f;h++)a+=d(e[h]);return x.btoa(a)}b(a)}}catch(g){}}function tc(a){var b=a.navigator.sendBeacon;a.navigator.sendBeacon=function(d,c){if(!wa(d)||16384<d.length)return b.apply(this,arguments);
var e=Ob(c);return bb(e,function(f){M({method:"POST",endpoint:d,payload:f,protocol:"beacon"})}),b.apply(this,arguments)}}function wc(a){var b=a.fetch;a.fetch=function(d,c){var e="GET",f=Promise.resolve(null);try{if("string"==typeof d)var h=d;else if(d instanceof Request)h=d.url,e=d.method,d.bodyUsed||d.keepalive||(f=d.clone().arrayBuffer()["catch"](function(){return null}));else if(d instanceof URL)h=d.href;else return b.apply(this,arguments);c&&(c.method&&(e=(c.method+"").toUpperCase()),c.body&&
(f=Promise.resolve(c.body)))}catch(m){}if("string"!=typeof h||16384<h.length)return b.apply(this,arguments);var g=b.apply(this,arguments);return f.then(function(m){bb(m,function(r){M({method:e,endpoint:h,payload:r,protocol:"fetch"})})}),g}}function vc(a){var b=a.WebSocket;a.WebSocket=function(c,e){return e?new b(c,e):new b(c)};var d=b.prototype.send;b.prototype.send=function(c){return M({method:"WS",endpoint:this.url,payload:c,protocol:"ws"}),d.apply(this,arguments)};a.WebSocket.prototype=b.prototype}
function xc(a){function b(d,c){try{d.getEntries().forEach(function(e){var f;if(f=wa(e.name)&&e.name.length<16384)f=e,f=(f=f.name.includes("contentsquare.net")&&"img"===f.initiatorType)||"iframe"===e.initiatorType||"script"===e.initiatorType;f&&M({method:"GET",endpoint:e.name,protocol:"performance"})})}catch(e){u(e)}}a=new PerformanceObserver(b);a.observe({entryTypes:["resource"]})}function uc(a){function b(d){try{var c=d?d.target:this,e={method:c.method,endpoint:c.action,payload:JSON.stringify({location:x.location.href,
form_id:c.id,method:c.method,form_data:Object.fromEntries(new FormData(c))}),protocol:"form"};M(e)}catch(f){}}a.addEventListener("submit",b,!0)}function yc(){function a(c){try{c&&c.contentWindow&&c.contentWindow.addEventListener("message",function(e){try{var f=e.data;if(f&&1===f.type){var h=f.command||{},g=h.params||{};if(g.url){var m={method:g.method||"GET",endpoint:g.url||"",payload:g.body||null,protocol:"message"};M(m)}}}catch(r){u(r)}})}catch(e){}}function b(){for(var c=document.getElementsByTagName("IFRAME"),
e=0;e<c.length;e++)a(c[e])}function d(){var c=new MutationObserver(function(e){e.forEach(function(f){f.addedNodes.forEach(function(h){"IFRAME"==h.tagName&&a(h)})})});c.observe(document,{subtree:!0,childList:!0,attributes:!1,characterData:!1});setTimeout(function(){c.disconnect()},5E3)}"complete"===document.readyState?(b(),d()):document.addEventListener("readystatechange",function(){"complete"===document.readyState&&(b(),d())})}function Ac(){try{Error.stackTraceLimit=20}catch(a){}try{return Error().stack.split("\n").slice(1).map(function(a){return a.trim()})}catch(a){return null}}
function M(a,b){b=b||!1;var d=Ac();a.ts=a.ts||(new Date).getTime();var c=function(){try{var e=Bc();if(!1===e)return la(S),cb=null,Ia.push(a),u({m:"Pre queued, queue length \x3d "+Ia.length,request:a}),void setTimeout(Cc,db);cb=e.sampleRate;a:{var f=a.endpoint,h=a.payload,g=a.protocol;if(wa(f)){if("data:"!==f.substring(0,5))for(var m in xa)if(xa.hasOwnProperty(m)){var r=m.split("@"),v=null;1<r.length&&(v=r[0]);var A=1<r.length?r[1]:r[0],w=A.split("%"),F=w[0],y=2===w.length?w[1]:null,E=Dc.slice();if(v){var G,
U=v.split(",");for(v=0;v<U.length;v++)if(G=U[v].trim(),G){var Q=G.charAt(0),da=G.substring(1);if("+"===Q){var ya=E.indexOf(da);-1!==ya&&E.splice(ya,1)}else"-"===Q&&-1===E.indexOf(da)&&E.push(da)}}if("string"!=typeof g||-1===E.indexOf(g))if(v=!0,null!==y&&("string"==typeof h?v=Pb(y,h.substring(0,65536)):v=!1),Pb(F,f.substring(0,1024))&&v){var L=xa[m];break a}}L=!1}else L=void 0}if("TRACKINGPLAN"==a.endpoint&&(L="trackingplan"),L){if(!(null===Ja||0<=Ja.indexOf(L)))return void u({m:"Request ignored ("+
L+" not in whitelist)",request:a});a:if(f=a,h=eb,0===h.length)var K=!0;else{for(g=0;g<h.length;g++)if(za.call(f,"payload")&&"string"==typeof f.payload&&0<=f.payload.indexOf(h[g])||za.call(f,"endpoint")&&"string"==typeof f.endpoint&&0<=f.endpoint.indexOf(h[g])){K=!0;break a}K=!1}if(!K)return void u({m:"Request ignored (content filter)",request:a});K=a;f=L;h=Ka;if(Ec(La,e))if(Ma){var I=fb(f,K,h);var V=I&&0<I.sampleRate?{rate:gb(I.sampleRate,e.sampleRate),rule:I.rule,mode:"ADAPTIVE/DEFAULT_DICE/EVENT_MATCHED"}:
{rate:e.sampleRate,rule:null,mode:"ADAPTIVE/DEFAULT_DICE/EVENT_NOT_MATCHED"}}else V={rate:e.sampleRate,rule:null,mode:"NOT_ADAPTIVE"};else V=Ma?(I=fb(f,K,h))&&0<I.sampleRate?Fc(I.sampleRate,e)?{rate:I.sampleRate,rule:I.rule,mode:"ADAPTIVE/EVENT_DICE/EVENT_MATCHED"}:null:null:null;if(V){e=a;I=d;K=e;f=L;var J=JSON.parse(ca(e)),ra=Qb(f),ma=ra.nameRegexKeys,ea=ra.valueRegexKeys;if(J.endpoint&&J.endpoint.includes("?")&&(J.endpoint=hb(J.endpoint,ma,ea,na,sa)),J.payload)try{var Na="string"==typeof J.payload?
J.payload:JSON.stringify(J.payload);try{var N=JSON.parse(Na);J.payload=JSON.stringify(Oa(N,ma,ea,na,sa))}catch(fa){J.payload=hb(Na,ma,ea,na,sa)}}catch(fa){ja({m:"Error masking payload",error:fa})}var Y=J;var Aa=Gc();var oa={provider:L,request:{endpoint:Y.endpoint,method:Y.method,post_payload:Y.payload||null,protocol:Y.protocol,href:x.location.href},ts:K.ts||(new Date).getTime(),dl_i:Rb().length-1,last_click_path:Sb,last_click_text:Tb,tags:Ub(),stack_trace:I,cookies:Aa.cookies,cookies_list:Aa.cookies_list,
sampling_rate:V.rate,adaptive_sampling_rule:V.rule,adaptive_sampling_mode:V.mode};ib(oa);var Z=ca(oa);if(2E5<Z.length&&u({m:"Track Too big, ignored: "+Z.length}),Ba)Vb(oa,S);else{var ta=ca(jb()).length;if(Z.length+2+ta>Ca)Vb(oa,S),u({m:"Track \x3e Batch Size: "+Z.length});else{var ha=aa.length+Z.length+ta;ha>Ca&&(u({m:"Batch reaching limit: "+ha}),la(S));ha=aa.length+Z.length+ta;u({m:"Queue len: "+ha,rawTrack:oa});0!==aa.length&&(aa+=",");aa+=Z}}}}}catch(fa){ja({m:"Trackingplan process error",error:fa,
request:a})}};b||pa?c():setTimeout(c,0)}function la(a){if(0!=aa.length){var b={requests:JSON.parse("["+aa+"]"),common:jb(!0)};aa="";Wb(b,a)}}function Vb(a,b){a={requests:[a],common:jb(!0)};Wb(a,b)}function Xb(){var a=kb+ba,b=[];return lb&&b.push("debug\x3dtrue"),null!=mb&&b.push("t\x3d"+mb),0<b.length&&(a+="?"+b.join("\x26")),a}function Yb(){var a=new XMLHttpRequest;return Pa&&(a.open=Zb,a.send=$b),a}function Wb(a,b){function d(e){var f=Xb();var h=e;f=(f=Pa?ac(f,h):x.navigator.sendBeacon(f,h))?"accepted":
"discarded";"accepted"==f&&Qa(e);u("Sent (sendBeacon): "+f)}function c(e){var f=Yb();f.open("POST",Xb(),!0);f.onreadystatechange=function(){4===f.readyState&&(Qa(e,f.response),u("Sent (XHR)"))};f.setRequestHeader("Content-Type","application/json;charset\x3dUTF-8");f.send(e)}if(u({m:"Sending",payload:a}),nb)return void u("Not sending (dry run)");"function"==typeof Ra&&(a=Ra(a),!1===a&&u("Not sending (onBeforeSubmit hook returned false)"));pa&&(b="xhr");a=ca(a);"xhr"===b?c(a):"beacon"===b&&d(a)}function Ec(a,
b){switch(a){case "user":return 0!==b.sampleRate&&1===b.isSampledUser;case "track":return 0!==b.sampleRate&&Math.random()<1/b.sampleRate;case "all":return!0;default:return!1}}function Rb(){if(!ob)return[];try{var a=pb();return"object"==typeof a[0]?a:[]}catch(b){return[]}}function Ub(){var a={},b;for(b in ia)try{var d="function"==typeof ia[b]?ia[b]():ia[b];void 0!==d&&(a[b]=d)}catch(c){u({m:"Error calculating tag value for key: "+b,error:c}),a[b]=null}return a=qb(a,100),a}function Gc(){var a,b=document.cookie,
d={},c=[];b=b.split(";");for(var e=0;e<b.length;e++)if(a=b[e].trim(),a){var f=a.split("\x3d"),h=f[0].trim();f=1<f.length?f.slice(1).join("\x3d").trim():"";c.push(h);for(var g,m=0;m<Sa.length;m++)if(g=Sa[m],"string"==typeof g&&2<g.length&&"/"===g.charAt(0)&&"/"===g.charAt(g.length-1))try{var r=new RegExp(g.slice(1,-1));if(r.test(h)){d[h]=f;break}}catch(v){if(h===g){d[h]=f;break}}else if(h===g){d[h]=f;break}}return c=c.filter(function(v,A){return c.indexOf(v)==A}),c.sort(),{cookies:d,cookies_list:c}}
function jb(a){var b=Rb(),d=b;return a&&b&&(d=Hc(b)),{context:X({hostname:x.location.hostname,user_agent:navigator.userAgent,navigator_language:navigator.language||navigator.userLanguage,load_url:ua},Nb()),tp_id:ba,source_alias:rb,environment:Ta,sdk:O.sdk,sdk_version:O.sdkVersion,sampling_rate:cb,debug:Da,datalayer:d,session_id:bc(),tags:Ub(),init_id:cc,real_time:Ba}}function Mb(){try{for(var a=x.performance.getEntriesByType("resource"),b={},d=[],c=0;c<a.length;c++){d.push(a[c].name);var e="",f=a[c].name.replace(/(^\w+:|^)\/\//,
""),h=f.split("?"),g=h[0];h=g.split("/");e=1<h.length?h[0]+"/"+h[1]:h[0];za.call(b,e)||(b[e]=0);b[e]++}return b}catch(m){return null}}function Cc(){function a(c){var e=c;var f=Ta;e=za.call(e,"environment_rates")&&za.call(e.environment_rates,f)?e.environment_rates[f]:e.sample_rate;if(dc(e))throw sb=(new Date).getTime()+3E5,Error("Invalid sampling rate");sb=0;Ua(e);if(c.options){try{q.setItem("_trackingplan_options",JSON.stringify(c.options))}catch(h){u({m:"Error storing options",error:h})}O.setOptions(ba,
c.options)}for(ka({event_name:"new_dau"});Ia.length;)c=Ia.shift(),M(c)}if(!(Va||(new Date).getTime()<sb))if(Va=!0,Wa)a(Wa),setTimeout(function(){Va=!1},3E3);else{u({m:"Downloading config..."});var b=Yb(),d=tb+"config-"+ba+".json";b.onreadystatechange=function(){if(4==this.readyState){u({m:"Config downloaded"});try{var c=JSON.parse(this.responseText);a(c)}catch(e){u({m:"Failed to download config",error:e})}}setTimeout(function(){Va=!1},3E3)};b.open("GET",d,!0);b.send()}}function bc(){if(!ub)return null;
var a=q.getItem("_trackingplan_session_id"),b=q.getItem("_trackingplan_session_ts");if(null===a||null===b)return u({m:"Session ID: Creating for the first time session "}),vb();var d=Date.now();b=parseInt(b,10);var c=60*wb*1E3;return isNaN(b)||d>b+c?(u({m:"Session ID: Updating because timeout"}),vb()):(q.setItem("_trackingplan_session_ts",d.toString()),a)}function vb(){var a="true"===q.getItem("_trackingplan_live_debug_mode"),b=ec();1==a&&(b="55555555"+b.substring(8));a=Date.now();return q.setItem("_trackingplan_session_id",
b),q.setItem("_trackingplan_session_ts",a.toString()),ab({session_landing:document.location.href,session_referrer:document.referrer}),ka({event_name:"new_session"}),b}function ec(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var c=0|(a+16*Math.random())%16;return a=xb(a/16),("x"===d?c:8|3&c).toString(16)});return b}function Ua(a){if(!1===a)return q.removeItem("_trackingplan_sample_rate"),q.removeItem("_trackingplan_sample_rate_ts"),q.removeItem("_trackingplan_is_sampled_user"),
void q.removeItem("_trackingplan_options");var b=Math.random()<1/a?1:0;u({m:"Trackingplan sample rate \x3d "+a+". isSampledUser "+b});q.setItem("_trackingplan_sample_rate_ts",(new Date).getTime());q.setItem("_trackingplan_sample_rate",a);q.setItem("_trackingplan_is_sampled_user",b)}function Bc(){var a=q.getItem("_trackingplan_sample_rate_ts");if(null===a)return!1;if(parseInt(a)+1E3*yb<(new Date).getTime())return u({m:"Trackingplan sample rate expired"}),Ua(!1),!1;a=parseInt(q.getItem("_trackingplan_sample_rate"));
return dc(a)?(u({m:"Trackingplan sample rate expired"}),Ua(!1),!1):{sampleRate:a,isSampledUser:parseInt(q.getItem("_trackingplan_is_sampled_user"))}}function Pb(a,b){return null===a||null===b?!0:(b=b.toString(),"/"===a.charAt(0)&&"/"===a.charAt(a.length-1))?(a=new RegExp(a.slice(1,-1)),a.test(b)):-1!==b.indexOf(a)}function X(a,b){for(var d in b)a[d]=b[d];return a}function u(a){Da&&P.log("TP "+ba,a)}function ja(a){x.console&&P.warn&&P.warn(a)}function qb(a,b){if("string"==typeof a&&a.length>b)return a.substring(0,
b-1)+"\u2026";if(Array.isArray(a))return a.map(function(c){return qb(c,b)});if("object"==typeof a&&null!==a){var d={};return Object.keys(a).forEach(function(c){d[c]=qb(a[c],b)}),d}return a}function va(a){try{Jb[a.name]=Math.round(a.value)}catch(b){}}function Ic(){try{var a=function(b){var d,c,e,f,h,g=Math.max,m=-1,r=function(n){addEventListener("pageshow",function(k){k.persisted&&(m=k.timeStamp,n(k))},!0)},v=function(){var n=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];
if(n&&0<n.responseStart&&n.responseStart<performance.now())return n},A=function(){var n=v();return n&&n.activationStart||0},w=function(n,k){var l=v(),t="navigate";return 0<=m?t="back-forward-cache":l&&(document.prerendering||0<A()?t="prerender":document.wasDiscarded?t="restore":l.type&&(t=l.type.replace(/_/g,"-"))),{name:n,value:void 0===k?-1:k,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(xb(8999999999999*Math.random())+1E12),navigationType:t}},F=function(n,k,l){try{if(PerformanceObserver.supportedEntryTypes.includes(n)){var t=
new PerformanceObserver(function(p){Promise.resolve().then(function(){k(p.getEntries())})});return t.observe(Object.assign({type:n,buffered:!0},l||{})),t}}catch(p){}},y=function(n,k,l,t){var p,B;return function(z){0<=k.value&&(z||t)&&((B=k.value-(p||0))||void 0===p)&&(p=k.value,k.delta=B,z=k.value,z=z>l[1]?"poor":z>l[0]?"needs-improvement":"good",k.rating=z,n(k))}},E=function(n){requestAnimationFrame(function(){return requestAnimationFrame(function(){return n()})})},G=function(n){document.addEventListener("visibilitychange",
function(){"hidden"===document.visibilityState&&n()})},U=function(n){var k=!1;return function(){k||(n(),k=!0)}},Q=-1,da=function(n){"hidden"===document.visibilityState&&-1<Q&&(Q="visibilitychange"===n.type?n.timeStamp:0,removeEventListener("visibilitychange",da,!0),removeEventListener("prerenderingchange",da,!0))},ya=function(){addEventListener("visibilitychange",da,!0);addEventListener("prerenderingchange",da,!0)},L=function(){return 0>Q&&(Q="hidden"!==document.visibilityState||document.prerendering?
1/0:0,ya(),r(function(){setTimeout(function(){Q="hidden"!==document.visibilityState||document.prerendering?1/0:0;ya()},0)})),{get firstHiddenTime(){return Q}}},K=function(n){document.prerendering?addEventListener("prerenderingchange",function(){return n()},!0):n()},I=[1800,3E3],V=function(n,k){k=k||{};K(function(){var l,t=L(),p=w("FCP"),B=F("paint",function(z){z.forEach(function(D){"first-contentful-paint"===D.name&&(B.disconnect(),D.startTime<t.firstHiddenTime&&(p.value=g(D.startTime-A(),0),p.entries.push(D),
l(!0)))})});B&&(l=y(n,p,I,k.reportAllChanges),r(function(z){p=w("FCP");l=y(n,p,I,k.reportAllChanges);E(function(){p.value=performance.now()-z.timeStamp;l(!0)})}))})},J=[.1,.25],ra=0,ma=1/0,ea=0,Na=function(n){n.forEach(function(k){k.interactionId&&(ma=gb(ma,k.interactionId),ea=g(ea,k.interactionId),ra=ea?(ea-ma)/7+1:0)})},N=[],Y=new Map,Aa=0,oa=[],Z=function(n){if(oa.forEach(function(t){return t(n)}),n.interactionId||"first-input"===n.entryType){var k=N[N.length-1],l=Y.get(n.interactionId);if(l||
10>N.length||n.duration>k.latency)l?n.duration>l.latency?(l.entries=[n],l.latency=n.duration):n.duration===l.latency&&n.startTime===l.entries[0].startTime&&l.entries.push(n):(k={id:n.interactionId,latency:n.duration,entries:[n]},Y.set(k.id,k),N.push(k)),N.sort(function(t,p){return p.latency-t.latency}),10<N.length&&N.splice(10).forEach(function(t){return Y["delete"](t.id)})}},ta=function(n){var k=self.requestIdleCallback||self.setTimeout,l=-1;return n=U(n),"hidden"===document.visibilityState?n():
(l=k(n),G(n)),l},ha=[200,500],fa=[2500,4E3],zb={},Ab=[800,1800],Jc=function l(k){document.prerendering?K(function(){return l(k)}):"complete"===document.readyState?setTimeout(k,0):addEventListener("load",function(){return l(k)},!0)},Ea={passive:!0,capture:!0},Kc=new Date,ic=function(k,l){c||(c=l,e=k,f=new Date,fc(removeEventListener),hc())},hc=function(){if(0<=e&&e<f-Kc){var k={entryType:"first-input",name:c.type,target:c.target,cancelable:c.cancelable,startTime:c.timeStamp,processingStart:c.timeStamp+
e};h.forEach(function(l){l(k)});h=[]}},Lc=function(k){if(k.cancelable){var l=(1E12<k.timeStamp?new Date:performance.now())-k.timeStamp;"pointerdown"==k.type?function(t,p){var B=function(){ic(t,p);D()},z=function(){D()},D=function(){removeEventListener("pointerup",B,Ea);removeEventListener("pointercancel",z,Ea)};addEventListener("pointerup",B,Ea);addEventListener("pointercancel",z,Ea)}(l,k):ic(l,k)}},fc=function(k){["mousedown","keydown","touchstart","pointerdown"].forEach(function(l){return k(l,Lc,
Ea)})},Bb=[100,300];return b.CLSThresholds=J,b.FCPThresholds=I,b.FIDThresholds=Bb,b.INPThresholds=ha,b.LCPThresholds=fa,b.TTFBThresholds=Ab,b.onCLS=function(k,l){l=l||{};V(U(function(){var t,p=w("CLS",0),B=0,z=[],D=function(C){C.forEach(function(R){if(!R.hadRecentInput){var Mc=z[0],Nc=z[z.length-1];B&&1E3>R.startTime-Nc.startTime&&5E3>R.startTime-Mc.startTime?(B+=R.value,z.push(R)):(B=R.value,z=[R])}});B>p.value&&(p.value=B,p.entries=z,t())},W=F("layout-shift",D);W&&(t=y(k,p,J,l.reportAllChanges),
G(function(){D(W.takeRecords());t(!0)}),r(function(){B=0;p=w("CLS",0);t=y(k,p,J,l.reportAllChanges);E(function(){return t()})}),setTimeout(t,0))}))},b.onFCP=V,b.onFID=function(k,l){l=l||{};K(function(){var t=L(),p=w("FID"),B=function(C){C.startTime<t.firstHiddenTime&&(p.value=C.processingStart-C.startTime,p.entries.push(C),W(!0))},z=function(C){C.forEach(B)},D=F("first-input",z);var W=y(k,p,Bb,l.reportAllChanges);D&&(G(U(function(){z(D.takeRecords());D.disconnect()})),r(function(){p=w("FID");W=y(k,
p,Bb,l.reportAllChanges);h=[];e=-1;c=null;fc(addEventListener);var C=B;h.push(C);hc()}))})},b.onINP=function(k,l){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(l=l||{},K(function(){var t;"interactionCount"in performance||d||(d=F("event",Na,{type:"event",buffered:!0,durationThreshold:0}));var p=w("INP"),B=function(W){ta(function(){W.forEach(Z);var C=gb(N.length-1,xb(((d?ra:performance.interactionCount||0)-Aa)/50));(C=N[C])&&C.latency!==p.value&&(p.value=C.latency,
p.entries=C.entries,D())})},z=F("event",B,{durationThreshold:null!==(t=l.durationThreshold)&&void 0!==t?t:40});var D=y(k,p,ha,l.reportAllChanges);z&&(z.observe({type:"first-input",buffered:!0}),G(function(){B(z.takeRecords());D(!0)}),r(function(){Aa=d?ra:performance.interactionCount||0;N.length=0;Y.clear();p=w("INP");D=y(k,p,ha,l.reportAllChanges)}))}))},b.onLCP=function(k,l){l=l||{};K(function(){var t=L(),p=w("LCP"),B=function(C){l.reportAllChanges||(C=C.slice(-1));C.forEach(function(R){R.startTime<
t.firstHiddenTime&&(p.value=g(R.startTime-A(),0),p.entries=[R],D())})},z=F("largest-contentful-paint",B);if(z){var D=y(k,p,fa,l.reportAllChanges);var W=U(function(){zb[p.id]||(B(z.takeRecords()),z.disconnect(),zb[p.id]=!0,D(!0))});["keydown","click"].forEach(function(C){addEventListener(C,function(){return ta(W)},!0)});G(W);r(function(C){p=w("LCP");D=y(k,p,fa,l.reportAllChanges);E(function(){p.value=performance.now()-C.timeStamp;zb[p.id]=!0;D(!0)})})}})},b.onTTFB=function(k,l){l=l||{};var t=w("TTFB"),
p=y(k,t,Ab,l.reportAllChanges);Jc(function(){var B=v();B&&(t.value=g(B.responseStart-A(),0),t.entries=[B],p(!0),r(function(){t=w("TTFB",0);(p=y(k,t,Ab,l.reportAllChanges))(!0)}))})},b}({});a.onCLS(va);a.onFCP(va);a.onFID(va);a.onINP(va);a.onLCP(va);a.onTTFB(va)}catch(b){}}function Oc(){x.addEventListener("error",function(b){Kb++});var a=P.warn;P.warn=function(){Lb++;a.apply(P,arguments)}}function Pc(){try{var a=q.getItem("_trackingplan_options");return a?JSON.parse(a):null}catch(b){return u({m:"Error getting stored options",
error:b}),null}}function jc(a){if(!a)return{};for(var b={},d=a.split("\x26"),c=0;c<d.length;c++)a=d[c].split("\x3d"),b[decodeURIComponent(a[0])]=decodeURIComponent(a[1]||"");return b}function fb(a,b,d){if(!Array.isArray(d)||!d.length)return null;d=d.filter(function(m){return m.provider===a});if(!d.length)return null;var c={};try{var e=new URL(b.endpoint);e.search&&(c=jc(e.search.substring(1)))}catch(m){}var f=[c],h=!1;e=null;if(b.payload)try{e=JSON.parse(b.payload),h=!0}catch(m){}!h&&b.payload&&"string"==
typeof b.payload&&b.payload.split("\n").forEach(function(m){if(m.trim()){m=jc(m);var r=X({},c);r=X(r,m);0<Object.keys(r).length&&f.push(r)}});var g;for(b=0;b<d.length;b++){if(g=d[b],!g.match)return{sampleRate:g.sample_rate,rule:g};for(h=0;h<f.length;h++)if(qa(g.match,f[h]))return{sampleRate:g.sample_rate,rule:g};if(e&&qa(g.match,e)||e&&(h=X({},c),h=X(h,e),qa(g.match,h)))return{sampleRate:g.sample_rate,rule:g}}return null}function Fc(a,b){b=1/b.sampleRate;if(1<=b||0>b)return!1;if(0<a){a=1/a;if(a<=
b)return!1;a=(a-b)/(1-b);return!(0>=a)&&Math.random()<a}return!1}function sa(a,b,d,c){var e=d;if(null===e)e="null";else{var f=typeof e;switch(f){case "number":f="number";break;case "boolean":f="boolean";break;case "string":f="string";break;case "object":f=Array.isArray(e)?"array":"object";break;default:f="n/a"}if("string"===f){var h=parseFloat(e);if(!isNaN(h)&&isFinite(e))f="number";else if(h=e.toLowerCase(),"true"===h||"false"===h)f="boolean";else try{var g=JSON.parse(e);Array.isArray(g)?f="array":
"object"==typeof g&&null!==g&&(f="object")}catch(m){}}e=f}g=null===d?-1:"string"==typeof d?d.length:d.toString().length;e="*ANON*"+c+"*"+b+"*"+a+"*"+e+"*"+g;return Cb&&P.log("TP Privacy Masking:",{originalKey:b,originalValue:d,maskedValue:e,rule:a,matchType:c}),e}function hb(a,b,d,c,e){function f(g,m,r,v){try{v=decodeURIComponent(v)}catch(G){}var A,w,F;for(A=0;A<b.length;A++){var y=b[A];var E=c.name_regexes[y]||[];for(w=0;w<E.length;w++)if(E[w].test(r))return F=e(y,r,v,"NAME"),m+r+"\x3d"+F}if(1024>
v.length)for(A=0;A<d.length;A++)for(y=d[A],E=c.value_regexes[y]||[],w=0;w<E.length;w++)if(E[w].test(v))return F=e(y,r,v,"VALUE"),m+r+"\x3d"+F;return g}var h=/([?&;\s]|^)([^=&;\s?]+)=([^&;\s]+)/g;return a.replace(h,f)}function Oa(a,b,d,c,e){function f(h,g){var m,r,v=g;if("string"==typeof g||"number"==typeof g||"boolean"==typeof g)for(m=0;m<b.length;m++){var A=b[m];var w=c.name_regexes[A]||[];for(r=0;r<w.length;r++)if(w[r].test(h))return v=e(A,h,g,"NAME"),v}if(null!==g&&("string"==typeof g||"number"==
typeof g)){var F=g.toString();if(1024>F.length)for(m=0;m<d.length;m++)for(A=d[m],w=c.value_regexes[A]||[],r=0;r<w.length;r++)if(w[r].test(F))return v=e(A,h,g,"VALUE"),v}if("string"==typeof g&&1<g.length&&("{"===g.charAt(0)&&"}"===g.charAt(g.length-1)||"["===g.charAt(0)&&"]"===g.charAt(g.length-1)))try{var y=JSON.parse(g),E=f(h,y);return JSON.stringify(E)}catch(U){}if(Array.isArray(g))return g.map(function(U,Q){return f(h+"["+Q+"]",U)});if("object"==typeof g&&null!==g){var G;m={};for(G in g)g.hasOwnProperty(G)&&
(m[G]=f(G,g[G]));return m}return g}return f("",a)}function Qc(a){function b(d){for(var c in d)d.hasOwnProperty(c)&&("object"==typeof d[c]&&null!==d[c]?b(d[c]):-1!==Fa.indexOf(c)&&(d[c]=sa("legacy",c,d[c],!0)));return d}if(!Array.isArray(Fa)||0==Fa.length)return a;a=JSON.parse(ca(a));return a.map(function(d){return"object"==typeof d&&null!==d?b(d):d})}function Hc(a){if(Xa&&H){var b=Qb("datalayer");var d=b.nameRegexKeys,c=b.valueRegexKeys;0<d.length||0<c.length?Array.isArray(a)?(b=a.slice(Ya.lastProcessedLength),
b=JSON.parse(ca(b)),b=b.map(function(e){return"object"==typeof e&&null!==e?Oa(e,d,c,na,sa):e}),b=Ya.maskedItems.concat(b),Ya.lastProcessedLength=a.length,Ya.maskedItems=b):(b=JSON.parse(ca(a)),b=Oa(b,d,c,na,sa)):b=JSON.parse(ca(a))}else b=a;return b=Qc(b),b}function kc(a){return new RegExp(a,"i")}function Qb(a){var b=[],d=[];H.provider_rules&&H.provider_rules.provider_specific&&H.provider_rules.provider_specific[a]&&(a=H.provider_rules.provider_specific[a],a.name_regexes&&(b=b.concat(a.name_regexes)),
a.value_regexes&&(d=d.concat(a.value_regexes)));H.provider_rules&&H.provider_rules.global&&(a=H.provider_rules.global,a.name_regexes&&(b=b.concat(a.name_regexes)),a.value_regexes&&(d=d.concat(a.value_regexes)));return{nameRegexKeys:b,valueRegexKeys:d}}function qa(a,b){if(!a||"object"!=typeof a)return!1;if(a.and&&Array.isArray(a.and))return a.and.every(function(c){return qa(c,b)});if(a.or&&Array.isArray(a.or))return a.or.some(function(c){return qa(c,b)});if(a.not)return!qa(a.not,b);var d=Object.keys(a);
return d.every(function(c){var e=a[c];return Array.isArray(e)?e.some(function(f){return Za(b,c,f+"")}):Za(b,c,e+"")})}function Za(a,b,d){if(!a)return!1;if(Array.isArray(a)){for(var c=0;c<a.length;c++)if(Za(a[c],b,d))return!0;return!1}if("object"==typeof a)for(c in a)if(a.hasOwnProperty(c)&&(c===b&&"string"==typeof a[c]&&a[c]===d||null!==a[c]&&"object"==typeof a[c]&&Za(a[c],b,d)))return!0;return!1}var xb=Math.floor,dc=Number.isNaN,gb=Math.min;if(x.Trackingplan)return void(x.Trackingplan.testing||ja("Trackingplan snippet included twice."));
var Dc=["performance"],xa={"/g/collect?v\x3d2\x26tid":"googleanalytics","/\\/[a-z0-9]{6}\\?tid\x3d[^\x26]+\x26v\x3d2/":"googleanalytics","api.segment.io":"segment",segmentapi:"segment","seg-api":"segment","segment-api":"segment","/.*api-iam.intercom.io/messenger/web/(ping|events|metrics|open).*/":"intercom","api.amplitude.com":"amplitude","amplitude.com/2/httpapi":"amplitude","ping.chartbeat.net":"chartbeat","/.*api(-eu)?(-js)?.mixpanel.com.*/":"mixpanel","trk.kissmetrics.io":"kissmetrics","ct.pinterest.com":"pinterest",
"facebook.com/tr/":"facebook","track.hubspot.com/__":"hubspot","/.*.heapanalytics.com/(h|api).*/":"heap","/.*snowplow.*/":"snowplow","/.*ws.*.hotjar.com/api/v2/client/ws/%identify_user":"hotjar","/.*ws.*.hotjar.com/api/v2/client/ws/%tag_recording":"hotjar","klaviyo.com/api/track":"klaviyo","app.pendo.io/data":"pendo","matomo.php":"matomo","rs.fullstory.com/rec%8137":"fullstory","rs.fullstory.com/rec%8193":"fullstory","logx.optimizely.com/v1/events":"optimizely","track.customer.io/events/":"customerio",
"alb.reddit.com/rp.gif":"reddit","px.ads.linkedin.com":"linkedin","/i/adsct":"twitter","bat.bing.com":"bing","pdst.fm":"podsights","analytics.tiktok.com/api/v2":"tiktok","/.*AQB\x3d1.*AQE\x3d1/":"adobe","posthog.com/i/":"posthog","posthog.com/e/":"posthog","/.*tealiumiq.com/.*.gif/":"tealium",".connectif.cloud":"connectif","/ppms.php":"piwikpro","plausible.io/api/event":"plausible","ariane.abtasty.com":"abtasty","xiti.com/event":"piano","pa-cd.com/event":"piano","rudderstack.com/v1":"rudderstack",
"/dev.visualwebsiteoptimizer.com/.*events/":"vwo","adsmurai.com/v1.0/events":"adsmurai","+performance@/.*/pagead/(viewthroughconversion|conversion)/.*/":"google_ads","+performance@/.*(/activity|/fls).*src\x3d/":"floodlight","+performance@sslwidget.criteo.com/event":"criteo","+performance@track.adform.net/Serving/TrackPoint":"adform","/.*edge\\.adobedc\\.net\\/ee\\/.*(collect|interact).*/":"adobexdm","hits.getelevar.com":"elevar","a/elevar?source_url":"elevar","+performance@/.*awin1.com/.*.php.*/":"awin",
"+performance,-beacon,-img,-fetch,-message,-xhr@/^(?\x3d.*/c\\..*contentsquare\\.net/(?!v2)).*$/":"contentsquare"},na={name_regexes:{},value_regexes:{}},ba=null,Ta="PRODUCTION",rb=null,S="xhr",Da=!1,kb="https://tracks.trackingplan.com/v1/",tb="https://config.trackingplan.com/",db=0,yb=86400,sb=0,La="user",Ca=55E3,Db=20,T="img xhr beacon fetch performance message".split(" "),Eb=!1,nb=!1,Qa=function(){},ib=function(){},Ra=function(a){return a},lb=!1,ia={_utag_gdpr_selected_categories:function(){return x.utag&&
x.utag.gdpr&&"function"==typeof x.utag.gdpr.getSelectedCategories?x.utag.gdpr.getSelectedCategories():void 0}},Ga=null,eb=[],Ja=null,Ba=!1,pb=function(){return x.dataLayer},ob=!0,Pa=!1,Sa="OptanonConsent CookieConsent cmapi_cookie_privacy euconsent-v2 euconsent fs-cc cookieyes-consent CookieScriptConsent".split(" "),mb=null,pa=!1,Fa="userId user_id userid password pass token userToken usertoken user_token".split(" "),Xa=!1,Cb=!1,H={name_regexes:{age:["(user|person|customer)[_\\- ]?age$|^age$"],date_of_birth:["birth[_\\- ]?day|birth[_\\- ]?date|date[_\\- ]?of[_\\- ]?birth"],
certificate:["certificate$"],citizenship:["nationality|citizenship"],city:["city|town|municipality"],country:["country|(?\x3c!desti)nation(?!al)"],credit_card:["credit[_\\- ]?card|cc[_\\- ]?number|^visa$"],ethnicity:["ethnic[_\\- ]?group|ethnic[_\\- ]?minority|ethnicity|^race$"],gender:["gender|^sex$"],geolocation:["geolocation|geolocali[sz]ation|geoposition"],health:["disability|disease|illness|sickness|^infection$"],ip:["ip[_\\- ]?address|^ip$"],license:["license$"],link:["link$|url$"],name:["(first|last|full|person)[_\\- ]?name"],
password:["password|pwd"],phone:["phone|fax"],po_box:["p[_\\- ]?o[_\\- ]?box"],religion:["religion|faith|creed"],salary:["salary|wage|compensation|paycheck"],sexual_orientation:["sexual[_\\- ]?orientation"],ssn:["social[_\\- ]?security|ssn"],street_address:["address|street|province|place(?!ment)"],user_id:["user[_\\- ]?name|user[_\\- ]?id|nick[_\\- ]?name|^user$"],veteran_status:["veteran[_\\- ]?status"],zip_code:["zip[_\\- ]?code|postal[_\\- ]?code"],dni:["(^|[_\\.\\-\\s])dni([_\\.\\-\\s]|$)"],nie:["(^|[_\\.\\-\\s])nie([_\\.\\-\\s]|$)"],
passport:["(^|[_\\.\\-\\s])(passport|pasaporte)([_\\.\\-\\s]|$)"]},value_regexes:{credit_card:["(?:\\d{4}[- ]){3}(\\d{4}|\\d{3})|\\d{4}[- ]\\d{6}[- ]\\d{5}"],email:["([a-z0-9!#$%\x26'*+\\/\x3d?^_{|.}~-]+@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)"],gender:["^(male|female|man|woman|men|women|masculine|feminine|masc|fem|transgender|transgender male|transgender female)$"],ip:["^((?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|localhost)$",
"^(?:(?:[A-Fa-f0-9]{1,4}:){7}[A-Fa-f0-9]{1,4}|::(?:[A-Fa-f0-9]{1,4}:){0,6}[A-Fa-f0-9]{0,4})$"],phone:["^(?:(?:\\+|00)?\\d{1,3}[-\\. ])?((?:\\(\\d{3}\\)|\\d{3})[-\\. ]\\d{3}[-\\. ]?\\d{4}(?:[-\\. ]?(?:ext|extension)[-\\. ]?\\d+)?)$"],po_box:["P\\.? ?O\\.? Box \\d+"],sexual_orientation:["gay|lesbian|homosexual|heterosexual|queer|bisexual|pansexual|asexual"],ssn:["(?!000|666|333)0*(?:[0-6][0-9][0-9]|[0-7][0-6][0-9]|[0-7][0-7][0-2])[- ](?!00)[0-9]{2}[- ](?!0000)[0-9]{4}"],street_address:["\\d{1,4} [\\w\\s]{1,20}(?:street|st|avenue|ave|road|rd|highway|hwy|square|sq|trail|trl|drive|dr|court|ct|park|parkway|pkwy|circle|cir|boulevard|blvd)\\W?(?\x3d\\s|$)"],
nif:["^[A-Za-z][0-9]{8}[A-Za-z]$"],dni:["\\b\\d{8}[A-HJ-NP-TV-Z]\\b"],nie:["\\b[XYZ]\\d{7}[A-HJ-NP-TV-Z]\\b"]},provider_rules:{global:{name_regexes:"age certificate citizenship city country credit_card date_of_birth dni ethnicity gender geolocation health ip license name nie passport password phone po_box religion salary sexual_orientation ssn street_address user_id veteran_status zip_code".split(" "),value_regexes:"credit_card dni email gender ip nie nif phone po_box sexual_orientation ssn street_address".split(" ")}}},
Ka=[],Ma=!1,Va=!1,lc="_trackingplan_session_id",$a="_trackingplan_live_debug_mode",Ia=[],aa="",cb=null,ua="",cc="",wb=30,ub=!0,Fb=!0,Sb=null,Tb=null,Jb={},Kb=0,Lb=0,Ha=!1,Wa=null,Ya={lastProcessedLength:0,maskedItems:[]},O=x.Trackingplan={sdk:"js",sdkVersion:"1.33.1",options:null,tpId:null,testing:!1,setOptions:function(a,b){b=this.options=b||{};ba=this.tpId=a;Ta=b.environment||Ta;rb=b.sourceAlias||rb;Xa="boolean"==typeof b.usePrivacy?b.usePrivacy:Xa;H=b.privacyConfig||H;S=b.sendMethod||S;xa=X(xa,
b.customDomains||{});Da="boolean"==typeof b.debug?b.debug:Da;kb=b.tracksEndPoint||kb;tb=b.configEndPoint||tb;db=b.delayConfigDownload||db;yb=b.sampleRateTTL||yb;La=b.samplingMode||La;Ca=b.batchSize||Ca;Db=b.batchInterval||Db;Eb=typeof b.alwaysSendNewUser?b.alwaysSendNewUser:Eb;nb="boolean"==typeof b.dryRun?b.dryRun:nb;T=b.intercept||T;Qa=b.onSubmit||Qa;lb=b.parse||lb;ib=b.onQueue||ib;Ra=b.onBeforeSubmit||Ra;ia=X(ia,b.tags||{});Ga=b.samplingRate||Ga;eb=b.contentFilters||eb;Ja=b.providersWhitelist||
Ja;Ba="boolean"==typeof b.realtime?b.realtime:Ba;pb=b.getDataLayer||pb;wb=b.sessionDurationMinutes||wb;Fb="undefined"==typeof b.intervalsOnInit?Fb:b.intervalsOnInit;Sa=b.cookiesWhitelist||Sa;ob="boolean"==typeof b.useDataLayer?b.useDataLayer:ob;Pa="boolean"==typeof b.useNativeSend?b.useNativeSend:Pa;ub="boolean"==typeof b.useSessions?b.useSessions:ub;Ma="boolean"==typeof b.useAdaptiveSampling?b.useAdaptiveSampling:Ma;Wa=b.configFileOverride||Wa;Fa=b.datalayerMaskKeys||Fa;Cb="boolean"==typeof b.debugPrivacy?
b.debugPrivacy:Cb;Array.isArray(b.adaptiveSamplingPatterns)&&(Ka=b.adaptiveSamplingPatterns.concat(Ka));pa=this.testing=b.testing||pa;Ba&&(Ga=1,La="all",Ca=1);pa&&(mb=Date.now());u({m:"TP options updated",options:b});if(Xa&&H&&H){for(var d in H.name_regexes)na.name_regexes[d]=H.name_regexes[d].map(kc);for(d in H.value_regexes)na.value_regexes[d]=H.value_regexes[d].map(kc)}},getAdaptiveSamplingPatterns:function(){return Ka},getPrivacyConfig:function(){return H},init:function(a,b){try{if(pa)return void ja("Trackingplan SDK is running in a test environment");
if(!zc())throw Error("TP Not compatible browser");if(null!==ba)throw Error("TP Init already happened");if("string"!=typeof a||""===a)throw Error("tpId is not provided");if(ua=null,x.performance&&x.performance.getEntriesByType){var d=x.performance.getEntriesByType("navigation")[0];ua=d?d.name:x.location.href}else ua=x.location.href;mc(ua);var c=nc();c&&(P.log("TP Running in regression mode",c),b=b||{},b.testing=!0,b.realtime=!0,b.samplingMode="all",b.tags=b.tags||{},b.tags.test_session_name=c.test_session_name,
b.tags.test_title=c.test_title,b.environment=c.environment);oc(ua);var e="true"===q.getItem($a);e&&(b=b||{},b.realtime=!0,b.samplingMode="all");O.setOptions(a,b);Da&&(x.Trackingplan.xhr={open:Zb,send:$b},x.Trackingplan.beacon={sendBeacon:ac});var f=Pc();null!==f&&O.setOptions(a,f);null!==Ga&&Ua(Ga);cc=ec();qc(x);document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&setTimeout(function(){la("beacon");u({m:"visibility beacon"})},3E3)});x.addEventListener("pagehide",
Hb);x.addEventListener("beforeunload",Hb);x.document.addEventListener("click",function(g){a:{var m=g.target;try{if(m instanceof Element){for(var r=[];m.nodeType===Node.ELEMENT_NODE&&"html"!==m.nodeName.toLowerCase()&&"body"!==m.nodeName.toLowerCase();){var v=m.nodeName.toLowerCase();if(m.id){v+="#"+m.id;r.unshift(v);break}else{m.className&&(v+="."+m.className.split(" ").join(".").replace(/\s+/g,"."));for(var A=m,w=1;A=A.previousElementSibling;){var F=A.nodeName.toLowerCase();A.className&&(F+="."+
A.className.split(" ").join(".").replace(/\s+/g,"."));F===v&&w++}1!=w&&(v+=":nth-of-type("+w+")")}r.unshift(v);m=m.parentNode}var y=r.join(" \x3e ");break a}}catch(G){y=null;break a}y=void 0}Sb=y;a:{g=g.target;try{if(!(g instanceof Element)){var E=null;break a}y=null;E=("input"===g.tagName.toLowerCase()&&"password"!==g.type?y=g.value.trim():"input"!==g.tagName.toLowerCase()&&"script"!==g.tagName.toLowerCase()&&"style"!==g.tagName.toLowerCase()&&(y=g.textContent.trim()),y?y.slice(0,50):null);break a}catch(G){E=
null;break a}E=void 0}Tb=E},!1);(null===q.getItem("_trackingplan_initial")||Eb)&&(u({m:"New User"}),ab({landing:document.location.href,referrer:document.referrer}),ka({event_name:"new_user"}));/[?&]utm_[^=]+/.test(document.location.search)&&ab({last_utm_page:document.location.href});var h=bc();e&&pc(h);ka({event_name:"page_load"});!0===Fb&&O.initIntervals();Ic();Oc();u({m:"TP init finished",options:b})}catch(g){ja({m:"TP init error",error:g})}},flush:function(){la(S)},queueSize:function(){return aa.length},
updateTags:function(a){la(S);ia=X(ia,a)},initIntervals:function(){pa||setTimeout(function(){Ha||(ka({event_name:"pixels",properties:{pixels:Mb(),sent_at:"timeout"}}),Ha=!0)},1E4);setInterval(function(){la(S)},1E3*Db)},getSessionId:function(){return q.getItem(lc)},enableLiveDebugMode:function(){q.setItem($a,"true");vb();x.location.reload()},disableLiveDebugMode:function(){localStorage.removeItem($a);x.location.reload()},clearStorageAndReload:function(){q.removeItem("_trackingplan_sample_rate");q.removeItem("_trackingplan_sample_rate_ts");
q.removeItem("_trackingplan_is_sampled_user");q.removeItem("_trackingplan_initial");q.removeItem("_trackingplan_options");q.removeItem(lc);q.removeItem("_trackingplan_session_ts");q.removeItem($a);q.removeItem("_trackingplan_regression");x.location.reload()}},Ib=!1,Zb=x.XMLHttpRequest.prototype.open,$b=x.XMLHttpRequest.prototype.send,ac=x.navigator.sendBeacon,za=Object.prototype.hasOwnProperty;O.maskQueryStrings=hb;O.maskJSONObject=Oa;O.matchSamplingRules=fb;O.evaluateMatchCondition=qa;O.processRequest=
M;"undefined"!=typeof module&&module.exports&&(module.exports=O)})(window,localStorage,console);Trackingplan.init("TP4332884",{environment:"PRODUCTION",tracksEndPoint:"https://eu-tracks.trackingplan.com/v1/",tags:{gtm_container_version:"349"}});</script><script type="text/javascript" id="" charset="">(function(a,e,f,g,b,c,d){a.WisePopsObject=b;a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};a[b].l=1*new Date;c=e.createElement(f);d=e.getElementsByTagName(f)[0];c.defer=1;c.src=g;d.parentNode.insertBefore(c,d)})(window,document,"script","//loader.wisepops.com/get-loader.js?v\x3d1\x26site\x3dNYtyE7fa8V","wisepops");</script>

<script type="text/javascript" id="" charset="">$("#promoCodeBox").appendTo(".tertiary-linked-features");</script>
<script id="" text="" charset="" type="text/javascript" src="https://js.adsrvr.org/up_loader.1.1.0.js"></script><iframe height="0" width="0" style="display: none; visibility: hidden;"></iframe><script type="text/javascript" id="" charset="">!function(d,g,e){d.TiktokAnalyticsObject=e;var a=d[e]=d[e]||[];a.methods="page track identify instances debug on off once ready alias group enableCookie disableCookie".split(" ");a.setAndDefer=function(b,c){b[c]=function(){b.push([c].concat(Array.prototype.slice.call(arguments,0)))}};for(d=0;d<a.methods.length;d++)a.setAndDefer(a,a.methods[d]);a.instance=function(b){b=a._i[b]||[];for(var c=0;c<a.methods.length;c++)a.setAndDefer(b,a.methods[c]);return b};a.load=function(b,c){var f="https://analytics.tiktok.com/i18n/pixel/events.js";
a._i=a._i||{};a._i[b]=[];a._i[b]._u=f;a._t=a._t||{};a._t[b]=+new Date;a._o=a._o||{};a._o[b]=c||{};c=document.createElement("script");c.type="text/javascript";c.async=!0;c.src=f+"?sdkid\x3d"+b+"\x26lib\x3d"+e;b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(c,b)};a.load("CJMT2H3C77UDFRIUMFEG");a.page()}(window,document,"ttq");</script>

<!-- contains bootstrap specific function declarations -->
<script src="bootstrap-functions.js?_=7.85.1" type="text/javascript"></script>
<!-- Logout Handler -->
<script>
$(document).ready(function() {
    var body = $("body");
    
    body
    .on("logged-out", function(e) {
        var targetPage = "error.asp?";
        window.location.assign("login.asp?targetPage="+encodeURIComponent(targetPage));
    });
    
    // on pressing Enter key on an anchor trigger click
    $("a").keypress(function(e){
      if(e.keyCode == 13){
        $(this).trigger("click");
      }
    });
    
    // When page is loaded make sure the Page Load Spinner is not shown
    if (spinnerDelayTimeout) {
        cancelSpinnerTimeouts();
    }
    
    body.removeClass("show-spinner");
    
    // Show spinner when form submitted or link clicked
    var onSubmit;
    $("form").each(
      //Trigger the spinner after any other onsubmit functions for the form
      function(index)
      {
        onSubmit = $(this).attr("onsubmit");
        if ( onSubmit && onSubmit != "" ) {
          onSubmit = onSubmit.trim();
          // if the submit is "returning", we need to && showSpinner otherwise it won't be called
          var returnIndex = onSubmit.indexOf("return");
          if ( returnIndex != -1 ) {
            // remove any trailing semi-colons
            if ( onSubmit.indexOf(";") == onSubmit.length-1 )
              onSubmit = onSubmit.substr(0, onSubmit.length-1);

            // wrap the return in () in case it contains ||
            // (add 6 to strip the original "return")
            onSubmit = onSubmit.substr(0, returnIndex) + "return (" + onSubmit.substr(returnIndex + 6) + ")";

            // and then append the call to the spinner
            onSubmit += " && showSpinner()";
          }
          else {
            onSubmit += ";showSpinner()";
          }
        }
        else {
          onSubmit = "showSpinner()";
        }
        $(this).attr("onsubmit", onSubmit);
      }
    );

    // attach an event listener to each <a> tag to show the spinner if needed
    // only do this if the <a> tag has an "href" attribute, so we don't show
    // the spinner if staying on the page.  If navigating away from the page
    // via an onClick, we are assuming the onClick handles the display of the spinner
    // (or submits the form with jQuery, so the spinner attached to the form.submit
    // is fired)
    $("a").click(function(e) {
      var href = $(this).attr("href") || "";
      var target = $(this).attr("target") || "";

      if ((target == "" || /^(_self|_top|_parent)/.test(href)) && href != "" && !/^(#|javascript:|mailto:|file:)/.test(href))
        showSpinner();
    });
});
</script>
<!-- CONTENT END -->

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c61d5503aab074d',t:'MTc2OTc4NTE2Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>



<script>
  $(function(){

    // "Continue Shopping" and "Look for other events" buttons to redirect back to Brochure page user came from
    $("a[name=continue-shopping], a[name=continueShopping], input[name=startOver], a[name=error-StartOver], input[name=error-StartOver]").on("click", function(e) {
      var returnTo = getCookie('returnTo');
      if(returnTo){
        e.preventDefault();
        deleteCookie('returnTo');
        window.location.href = returnTo;
      }
    })

    // "New Order" button to redirect to EIF home page
    $("input.new-order,input[name=cancel-order]").on("click", function(e){
         var returnTo = getCookie('returnTo');
          if(returnTo){
            e.preventDefault();
            $("#popupDiv_okayButton").on("click", function(e){
               $.ajax({
                 url: 'clearOrder.asp',
                 complete: function() {
                    deleteCookie('returnTo');
                    window.location.href = returnTo;    
                 }
                });
    
             });
          }
    })
  });

  //adding the returnTo to the cookie
  var returnTo = "undefined";

    if (returnTo) {
      var reffA = document.createElement('a');
      reffA.href = returnTo;

    if(reffA.host != window.location.host) {
      setCookie("returnTo", returnTo, 1);
    }
  }

  /*
    *****************************************************
    Cookie methods
    *****************************************************
  */
  function setCookie(cname, cvalue, exdays) {
      var d = new Date();
      d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
      var expires = "expires="+d.toUTCString();
      document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
  }

  function getCookie(cname) {
      var name = cname + "=";
      var ca = document.cookie.split(';');
      for(var i = 0; i < ca.length; i++) {
          var c = ca[i];
          while (c.charAt(0) == ' ') {
              c = c.substring(1);
          }
          if (c.indexOf(name) == 0) {
              return c.substring(name.length, c.length);
          }
      }
      return "";
  }

  function deleteCookie(cname) {
      setCookie(cname, "", -1);
  }
</script><iframe height="0" width="0" src="https://15344947.fls.doubleclick.net/activityi;src=15344947;type=bfivz0;cat=aka-b000;ord=5853594055693;npa=0;auiddc=1775119982.1769785168;u2=BFI%20Southbank%20header;uaa=x86;uab=64;uafvl=Chromium%3B143.0.7499.4%7CNot%2520A(Brand%3B24.0.0.0;uamb=0;uam=;uap=macOS;uapv=10_15_7;uaw=0;pscdl=noapi;frm=0;_tu=KFA;gtm=45fe61r1v9208464851z871417101za20gzb71417101zd71417101xea;gcd=13l3l3l3l1l1;dma=0;dc_fmt=2;tag_exp=103116026~103200004~104527907~104528500~104684208~104684211~115616985~115938466~115938468~116185181~116185182~116988315~117041587;epver=2;dc_random=1769785168_ubRxrZ5EPudch6YuHSjfOoaJkNIQ9xcSbw;_dc_test=1;~oref=https%3A%2F%2Fwhatson.bfi.org.uk%2FOnline%2Ferror.asp?" style="display: none; visibility: hidden;"></iframe><div style="display: none; visibility: hidden;">
<script>!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","367783743713127");fbq("track","PageView");</script>
<noscript></noscript>

</div>
        <script type="text/javascript" id="" charset="">ttd_dom_ready(function(){if("function"===typeof TTDUniversalPixelApi){var a=new TTDUniversalPixelApi;a.init("t983edd",["sn2px5o"],"https://insight.adsrvr.org/track/up")}});</script><iframe id="universal_pixel_sn2px5o" height="0" width="0" style="display:none;" src="https://insight.adsrvr.org/track/cei?advertiser_id=t983edd&amp;cookie_sync=1&amp;upv=3.0.0&amp;upid=sn2px5o&amp;ref=https://whatson.bfi.org.uk/Online/error.asp" title="TTD Universal Pixel"></iframe></body></html>